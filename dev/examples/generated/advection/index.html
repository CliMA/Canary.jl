<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advection Equation Example · Canary.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link href="../../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Canary.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../../">Home</a></li><li><a class="toctext" href="../../../manual/dg_intro/">Introduction to DG</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="../../../manual/mesh/">Mesh</a></li><li><a class="toctext" href="../../../manual/metric/">Metric Terms</a></li><li><a class="toctext" href="../../../manual/operators/">Element Operators</a></li></ul></li><li><span class="toctext">Examples</span><ul><li class="current"><a class="toctext" href>Advection Equation Example</a><ul class="internal"><li><a class="toctext" href="#Introduction-1">Introduction</a></li><li><a class="toctext" href="#Continuous-Governing-Equations-1">Continuous Governing Equations</a></li><li><a class="toctext" href="#Discontinous-Galerkin-Method-1">Discontinous Galerkin Method</a></li><li><a class="toctext" href="#Commented-Program-1">Commented Program</a></li><li><a class="toctext" href="#advection-plain-program-1">Plain Program</a></li></ul></li><li><a class="toctext" href="../shallow_water/">Shallow Water Equations Example</a></li></ul></li><li><span class="toctext">API Reference</span><ul><li><a class="toctext" href="../../../reference/mesh/">Mesh</a></li><li><a class="toctext" href="../../../reference/metric/">Metric Terms</a></li><li><a class="toctext" href="../../../reference/operators/">Element Operators</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Examples</li><li><a href>Advection Equation Example</a></li></ul><a class="edit-page" href="https://github.com/climate-machine/Canary.jl/blob/master/examples/advection.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Advection Equation Example</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Advection-Equation-Example-1" href="#Advection-Equation-Example-1">Advection Equation Example</a></h1><p><img src="../advection2d.png" alt/></p><h2><a class="nav-anchor" id="Introduction-1" href="#Introduction-1">Introduction</a></h2><p>This example shows how to solve the Advection or Transport equation in 1D, 2D, and 3D.</p><h2><a class="nav-anchor" id="Continuous-Governing-Equations-1" href="#Continuous-Governing-Equations-1">Continuous Governing Equations</a></h2><p>We solve the following equation:</p><div>\[\frac{\partial \rho}{\partial t} + \nabla \cdot \left( \rho \mathbf{u} \right) = 0 \; \; (1)\]</div><p>where <span>$\mathbf{u}=(u,v,w)$</span> depending on how many spatial dimensions we are using.  We only solve passive transport here so <span>$\mathbf{u}$</span> is given for all time and does not change. We employ periodic boundary conditions across all the walls of the domain.</p><h2><a class="nav-anchor" id="Discontinous-Galerkin-Method-1" href="#Discontinous-Galerkin-Method-1">Discontinous Galerkin Method</a></h2><p>To solve Eq. (1) in one, two, and three dimensions we use the Discontinuous Galerkin method with basis functions comprised of tensor products of one-dimensional Lagrange polynomials based on Lobatto points. Multiplying Eq. (1) by a test function <span>$\psi$</span> and integrating within each element <span>$\Omega_e$</span> such that <span>$\Omega = \bigcup_{e=1}^{N_e} \Omega_e$</span> we get</p><div>\[\int_{\Omega_e} \psi \frac{\partial \rho^{(e)}_N}{\partial t} d\Omega_e + \int_{\Omega_e} \psi \nabla \cdot \left( \rho \mathbf{u} \right)^{(e)}_N d\Omega_e = 0 \; \; (2)\]</div><p>where <span>$\rho^{(e)}_N=\sum_{i=1}^{(N+1)^{dim}} \psi_i(\mathbf{x}) \rho_i(t)$</span> is the finite dimensional expansion with basis functions <span>$\psi(\mathbf{x})$</span>.  Integrating Eq. (2) by parts yields</p><div>\[\int_{\Omega_e} \psi \frac{\partial \rho^{(e)}_N}{\partial t} d\Omega_e + \int_{\Gamma_e} \psi \mathbf{n} \cdot \left( \rho \mathbf{u} \right)^{(*,e)}_N d\Gamma_e - \int_{\Omega_e} \nabla \psi \cdot \left( \rho \mathbf{u} \right)^{(e)}_N d\Omega_e = 0 \; \; (3)\]</div><p>where the second term on the left denotes the flux integral term (computed in &quot;function fluxrhs&quot;) and the third term denotes the volume integral term (computed in &quot;function volumerhs&quot;).  The superscript <span>$(*,e)$</span> in the flux integral term denotes the numerical flux. Here we use the Rusanov flux.</p><h2><a class="nav-anchor" id="Commented-Program-1" href="#Commented-Program-1">Commented Program</a></h2><h3><a class="nav-anchor" id="Define-key-parameters:-1" href="#Define-key-parameters:-1">Define key parameters:</a></h3><p>N is polynomial order and brickN(Ne) generates a brick-grid with Ne elements in each direction</p><div><pre><code class="language-julia">N = 4 #polynomial order
#brickN = (10) #1D brickmesh
#brickN = (10, 10) #2D brickmesh
brickN = (10, 10, 10) #3D brickmesh
DFloat = Float64 #Number Type
tend = DFloat(0.01) #Final Time</code></pre><pre><code class="language-none">0.01</code></pre></div><h3><a class="nav-anchor" id="Load-the-MPI-and-Canary-packages-where-Canary-builds-the-mesh,-generates-basis-functions,-and-metric-terms.-1" href="#Load-the-MPI-and-Canary-packages-where-Canary-builds-the-mesh,-generates-basis-functions,-and-metric-terms.-1">Load the MPI and Canary packages where Canary builds the mesh, generates basis functions, and metric terms.</a></h3><div><pre><code class="language-julia">using MPI
using Canary
using Printf: @sprintf</code></pre></div><h3><a class="nav-anchor" id="The-grid-that-we-create-determines-the-number-of-spatial-dimensions-that-we-are-going-to-use.-1" href="#The-grid-that-we-create-determines-the-number-of-spatial-dimensions-that-we-are-going-to-use.-1">The grid that we create determines the number of spatial dimensions that we are going to use.</a></h3><div><pre><code class="language-julia">dim = length(brickN)</code></pre><pre><code class="language-none">3</code></pre></div><p>###Output the polynomial order, space dimensions, and element configuration</p><div><pre><code class="language-julia">println(&quot;N= &quot;,N)
println(&quot;dim= &quot;,dim)
println(&quot;brickN= &quot;,brickN)
println(&quot;DFloat= &quot;,DFloat)</code></pre><pre><code class="language-none">N= 4
dim= 3
brickN= (10, 10, 10)
DFloat= Float64</code></pre></div><h3><a class="nav-anchor" id="Initialize-MPI-and-get-the-communicator,-rank,-and-size-1" href="#Initialize-MPI-and-get-the-communicator,-rank,-and-size-1">Initialize MPI and get the communicator, rank, and size</a></h3><div><pre><code class="language-julia">MPI.Initialized() || MPI.Init() # only initialize MPI if not initialized
MPI.finalize_atexit()
mpicomm = MPI.COMM_WORLD
mpirank = MPI.Comm_rank(mpicomm)
mpisize = MPI.Comm_size(mpicomm)</code></pre><pre><code class="language-none">1</code></pre></div><h3><a class="nav-anchor" id="Generate-a-local-view-of-a-fully-periodic-Cartesian-mesh.-1" href="#Generate-a-local-view-of-a-fully-periodic-Cartesian-mesh.-1">Generate a local view of a fully periodic Cartesian mesh.</a></h3><div><pre><code class="language-julia">if dim == 1
  (Nx, ) = brickN
  local x = range(DFloat(0); length=Nx+1, stop=1)
  mesh = brickmesh((x, ), (true, ); part=mpirank+1, numparts=mpisize)
elseif dim == 2
  (Nx, Ny) = brickN
  local x = range(DFloat(0); length=Nx+1, stop=1)
  local y = range(DFloat(0); length=Ny+1, stop=1)
  mesh = brickmesh((x, y), (true, true); part=mpirank+1, numparts=mpisize)
else
  (Nx, Ny, Nz) = brickN
  local x = range(DFloat(0); length=Nx+1, stop=1)
  local y = range(DFloat(0); length=Ny+1, stop=1)
  local z = range(DFloat(0); length=Nz+1, stop=1)
  mesh = brickmesh((x, y, z), (true, true, true);
                   part=mpirank+1, numparts=mpisize)
end</code></pre><pre><code class="language-none">([1 2 … 1197 1198; 2 3 … 1198 1199; … ; 133 134 … 1329 1330; 134 135 … 1330 1331], [0.0 0.1 … 0.0 0.1; 0.0 0.0 … 0.1 0.1; 0.0 0.0 … 0.1 0.1]

[0.1 0.2 … 0.1 0.2; 0.0 0.0 … 0.1 0.1; 0.0 0.0 … 0.1 0.1]

[0.2 0.3 … 0.2 0.3; 0.0 0.0 … 0.1 0.1; 0.0 0.0 … 0.1 0.1]

...

[0.7 0.8 … 0.7 0.8; 0.9 0.9 … 1.0 1.0; 0.9 0.9 … 1.0 1.0]

[0.8 0.9 … 0.8 0.9; 0.9 0.9 … 1.0 1.0; 0.9 0.9 … 1.0 1.0]

[0.9 1.0 … 0.9 1.0; 0.9 0.9 … 1.0 1.0; 0.9 0.9 … 1.0 1.0], [0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], Array{Int64,1}[[10, 2, 1, 12, 122, 133], [20, 2, 12, 23, 133, 144], [30, 2, 23, 34, 144, 155], [40, 2, 34, 45, 155, 166], [50, 2, 45, 56, 166, 177], [60, 2, 56, 67, 177, 188], [70, 2, 67, 78, 188, 199], [80, 2, 78, 89, 199, 210], [90, 2, 89, 100, 210, 221], [91, 4, 1, 2, 122, 123]  …  [996, 6, 105, 106, 116, 117], [997, 4, 1096, 1097, 1217, 1218], [997, 6, 106, 107, 117, 118], [998, 4, 1097, 1098, 1218, 1219], [998, 6, 107, 108, 118, 119], [999, 4, 1098, 1099, 1219, 1220], [999, 6, 108, 109, 119, 120], [1000, 2, 1189, 1200, 1310, 1321], [1000, 4, 1099, 1100, 1220, 1221], [1000, 6, 109, 110, 120, 121]])</code></pre></div><h3><a class="nav-anchor" id="Partition-the-mesh-using-a-Hilbert-curve-based-partitioning-1" href="#Partition-the-mesh-using-a-Hilbert-curve-based-partitioning-1">Partition the mesh using a Hilbert curve based partitioning</a></h3><div><pre><code class="language-julia">mesh = partition(mpicomm, mesh...)</code></pre><pre><code class="language-none">([1 122 … 131 10; 2 123 … 132 11; … ; 133 254 … 263 142; 134 255 … 264 143], [0.0 0.1 … 0.0 0.1; 0.0 0.0 … 0.1 0.1; 0.0 0.0 … 0.1 0.1]

[0.0 0.1 … 0.0 0.1; 0.0 0.0 … 0.1 0.1; 0.1 0.1 … 0.2 0.2]

[0.0 0.1 … 0.0 0.1; 0.1 0.1 … 0.2 0.2; 0.1 0.1 … 0.2 0.2]

...

[0.9 1.0 … 0.9 1.0; 0.1 0.1 … 0.2 0.2; 0.1 0.1 … 0.2 0.2]

[0.9 1.0 … 0.9 1.0; 0.0 0.0 … 0.1 0.1; 0.1 0.1 … 0.2 0.2]

[0.9 1.0 … 0.9 1.0; 0.0 0.0 … 0.1 0.1; 0.0 0.0 … 0.1 0.1], [0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], Array{Int64,1}[[149, 6, 1, 2, 12, 13], [150, 6, 2, 3, 13, 14], [153, 6, 13, 14, 24, 25], [154, 6, 12, 13, 23, 24], [156, 6, 23, 24, 34, 35], [159, 6, 24, 25, 35, 36], [164, 6, 25, 26, 36, 37], [166, 6, 14, 15, 25, 26], [167, 6, 3, 4, 14, 15], [174, 6, 15, 16, 26, 27]  …  [971, 2, 155, 166, 276, 287], [974, 2, 23, 34, 144, 155], [975, 2, 144, 155, 265, 276], [982, 2, 265, 276, 386, 397], [983, 2, 243, 254, 364, 375], [984, 2, 254, 265, 375, 386], [997, 2, 12, 23, 133, 144], [998, 2, 133, 144, 254, 265], [999, 2, 122, 133, 243, 254], [1000, 2, 1, 12, 122, 133]])</code></pre></div><h3><a class="nav-anchor" id="Connect-the-mesh-in-parallel-1" href="#Connect-the-mesh-in-parallel-1">Connect the mesh in parallel</a></h3><div><pre><code class="language-julia">mesh = connectmesh(mpicomm, mesh...)</code></pre><pre><code class="language-none">(elems = 1:1000, realelems = 1:1000, ghostelems = 1001:1000, sendelems = Int64[], elemtocoord = [0.0 0.1 … 0.0 0.1; 0.0 0.0 … 0.1 0.1; 0.0 0.0 … 0.1 0.1]

[0.0 0.1 … 0.0 0.1; 0.0 0.0 … 0.1 0.1; 0.1 0.1 … 0.2 0.2]

[0.0 0.1 … 0.0 0.1; 0.1 0.1 … 0.2 0.2; 0.1 0.1 … 0.2 0.2]

...

[0.9 1.0 … 0.9 1.0; 0.1 0.1 … 0.2 0.2; 0.1 0.1 … 0.2 0.2]

[0.9 1.0 … 0.9 1.0; 0.0 0.0 … 0.1 0.1; 0.1 0.1 … 0.2 0.2]

[0.9 1.0 … 0.9 1.0; 0.0 0.0 … 0.1 0.1; 0.0 0.0 … 0.1 0.1], elemtoelem = [1000 999 … 994 993; 8 7 … 2 1; … ; 149 1 … 1000 852; 2 18 … 983 999], elemtoface = [2 2 … 2 2; 1 1 … 1 1; … ; 6 6 … 6 6; 5 5 … 5 5], elemtoordr = [1 1 … 1 1; 1 1 … 1 1; … ; 1 1 … 1 1; 1 1 … 1 1], elemtobndy = [0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], nabrtorank = Int64[], nabrtorecv = UnitRange{Int64}[], nabrtosend = UnitRange{Int64}[])</code></pre></div><h3><a class="nav-anchor" id="Get-the-degrees-of-freedom-along-the-faces-of-each-element.-1" href="#Get-the-degrees-of-freedom-along-the-faces-of-each-element.-1">Get the degrees of freedom along the faces of each element.</a></h3><p>vmap(:,f,e) gives the list of local (mpirank) points for the face &quot;f&quot; of element &quot;e&quot;.  vmapP points to the outward (or neighbor) element and vmapM for the current element. P=+ or right and M=- or left.</p><div><pre><code class="language-julia">(vmapM, vmapP) = mappings(N, mesh.elemtoelem, mesh.elemtoface, mesh.elemtoordr)</code></pre><pre><code class="language-none">([1 5 … 1 101; 6 10 … 2 102; … ; 116 120 … 24 124; 121 125 … 25 125]

[126 130 … 126 226; 131 135 … 127 227; … ; 241 245 … 149 249; 246 250 … 150 250]

[251 255 … 251 351; 256 260 … 252 352; … ; 366 370 … 274 374; 371 375 … 275 375]

...

[124626 124630 … 124626 124726; 124631 124635 … 124627 124727; … ; 124741 124745 … 124649 124749; 124746 124750 … 124650 124750]

[124751 124755 … 124751 124851; 124756 124760 … 124752 124852; … ; 124866 124870 … 124774 124874; 124871 124875 … 124775 124875]

[124876 124880 … 124876 124976; 124881 124885 … 124877 124977; … ; 124991 124995 … 124899 124999; 124996 125000 … 124900 125000], [124880 876 … 18601 126; 124885 881 … 18602 127; … ; 124995 991 … 18624 149; 125000 996 … 18625 150]

[124755 751 … 101 2126; 124760 756 … 102 2127; … ; 124870 866 … 124 2149; 124875 871 … 125 2150]

[124630 626 … 476 2001; 124635 631 … 477 2002; … ; 124745 741 … 499 2024; 124750 746 … 500 2025]

...

[124255 251 … 124601 122876; 124260 256 … 124602 122877; … ; 124370 366 … 124624 122899; 124375 371 … 124625 122900]

[124130 126 … 124976 122751; 124135 131 … 124977 122752; … ; 124245 241 … 124999 122774; 124250 246 … 125000 122775]

[124005 1 … 106476 124751; 124010 6 … 106477 124752; … ; 124120 116 … 106499 124774; 124125 121 … 106500 124775])</code></pre></div><h3><a class="nav-anchor" id="Create-1-D-operators-1" href="#Create-1-D-operators-1">Create 1-D operators</a></h3><div>\[\xi\]</div><p>and <span>$\omega$</span> are the 1D Lobatto points and weights and <span>$D$</span> is the derivative of the basis function.</p><div><pre><code class="language-julia">(ξ, ω) = lglpoints(DFloat, N)
D = spectralderivative(ξ)</code></pre><pre><code class="language-none">5×5 Array{Float64,2}:
 -5.0       6.7565       -2.66667       1.41016      -0.5
 -1.24099   4.44089e-16   1.74574      -0.763763      0.25901
  0.375    -1.33658       6.66134e-16   1.33658      -0.375
 -0.25901   0.763763     -1.74574      -2.66454e-15   1.24099
  0.5      -1.41016       2.66667      -6.7565        5.0</code></pre></div><h3><a class="nav-anchor" id="Compute-metric-terms-1" href="#Compute-metric-terms-1">Compute metric terms</a></h3><p>nface and nelem refers to the total number of faces and elements for this MPI rank. Also, coord contains the dim-tuple coordinates in the mesh.</p><div><pre><code class="language-julia">(nface, nelem) = size(mesh.elemtoelem)
coord = creategrid(Val(dim), mesh.elemtocoord, ξ)
if dim == 1
  x = coord.x
  for j = 1:length(x)
    x[j] = x[j]
  end
elseif dim == 2
  (x, y) = (coord.x, coord.y)
  for j = 1:length(x)
    (x[j], y[j]) = (x[j] .+ sin.(π * x[j]) .* sin.(2 * π * y[j]) / 10,
                    y[j] .+ sin.(2 * π * x[j]) .* sin.(π * y[j]) / 10)
  end
elseif dim == 3
  (x, y, z) = (coord.x, coord.y, coord.z)
  for j = 1:length(x)
    (x[j], y[j], z[j]) = (x[j] + (sin(π * x[j]) * sin(2 * π * y[j]) *
                                  cos(2 * π * z[j])) / 10,
                          y[j] + (sin(π * y[j]) * sin(2 * π * x[j]) *
                                  cos(2 * π * z[j])) / 10,
                          z[j] + (sin(π * z[j]) * sin(2 * π * x[j]) *
                                  cos(2 * π * y[j])) / 10)
  end
end</code></pre></div><h3><a class="nav-anchor" id="First-VTK-Call-1" href="#First-VTK-Call-1">First VTK Call</a></h3><p>This first VTK call dumps the mesh out for all mpiranks.</p><div><pre><code class="language-julia">include(joinpath(@__DIR__, &quot;vtk.jl&quot;))
writemesh(@sprintf(&quot;Advection%dD_rank_%04d_mesh&quot;, dim, mpirank), coord...;
          realelems=mesh.realelems)</code></pre></div><h3><a class="nav-anchor" id="Compute-the-metric-terms-1" href="#Compute-the-metric-terms-1">Compute the metric terms</a></h3><p>This call computes the metric terms of the grid such as <span>$\xi_\mathbf{x}$</span>, <span>$\eta_\mathbf{x}$</span>, <span>$\zeta_\mathbf{x}$</span> for all spatial dimensions <span>$\mathbf{x}$</span> depending on the dimension of <span>$dim$</span>.</p><div><pre><code class="language-julia">metric = computemetric(coord..., D)</code></pre><pre><code class="language-none">(J = [0.000125 0.000129252 … 0.000144506 0.000148082; 0.000133649 0.000138007 … 0.000153022 0.000156361; … ; 0.000167057 0.000171692 … 0.000185179 0.000187428; 0.000175427 0.000180108 … 0.000193089 0.000195025]

[0.000125 0.000129227 … 0.000144392 0.000147946; 0.000133617 0.000137951 … 0.000152879 0.000156197; … ; 0.000166891 0.000171504 … 0.000184909 0.000187137; 0.000175226 0.000179885 … 0.000192782 0.000194697]

[0.000125 0.000129044 … 0.000143552 0.000146952; 0.00013338 0.000137536 … 0.000151828 0.000154996; … ; 0.000165677 0.000170126 … 0.000182929 0.000185009; 0.000173754 0.000178248 … 0.000190536 0.000192298]

[0.000125 0.00012869 … 0.00014193 0.000145033; 0.000132921 0.000136733 … 0.000149796 0.000152675; … ; 0.000163334 0.000167464 … 0.000179108 0.000180904; 0.000170915 0.000175089 … 0.000186205 0.000187678]

[0.000125 0.00012844 … 0.000140781 0.000143674; 0.000132595 0.000136163 … 0.000148355 0.000151029; … ; 0.000161675 0.000165578 … 0.000176403 0.000178; 0.000168906 0.000172853 … 0.000183143 0.000184414]

[0.000125 0.00012844 … 0.000140781 0.000143674; 0.000132595 0.000136163 … 0.000148355 0.000151029; … ; 0.000161675 0.000165578 … 0.000176403 0.000178; 0.000168906 0.000172853 … 0.000183143 0.000184414]

[0.000125 0.000128149 … 0.000139447 0.000142095; 0.000132216 0.0001355 … 0.00014668 0.000149116; … ; 0.000159748 0.000163387 … 0.000173263 0.000174631; 0.000166573 0.000170257 … 0.000179593 0.000180631]

[0.000125 0.000127499 … 0.000136466 0.000138567; 0.000131364 0.000134012 … 0.000142928 0.000144836; … ; 0.00015544 0.000158486 … 0.000166249 0.000167115; 0.000161366 0.000164458 … 0.000171677 0.000172211]

[0.000125 0.000126744 … 0.000133001 0.000134468; 0.000130365 0.000132272 … 0.000138554 0.000139847; … ; 0.000150429 0.000152779 … 0.0001581 0.0001584; 0.000155318 0.000157718 … 0.000162506 0.000162477]

[0.000125 0.000126314 … 0.000131028 0.000132133; 0.00012979 0.000131274 … 0.000136053 0.000136998; … ; 0.00014757 0.000149519 … 0.000153454 0.000153441; 0.000151872 0.000153875 … 0.000157292 0.000156954]

[0.000143674 0.000146347 … 0.000153974 0.000155215; 0.000151029 0.000153409 … 0.000159316 0.000159977; … ; 0.000178 0.000179013 … 0.000177488 0.000175738; 0.000184414 0.000185028 … 0.000181446 0.00017905]

[0.000142095 0.000144542 … 0.000151524 0.00015266; 0.000149116 0.000151276 … 0.000156548 0.000157103; … ; 0.000174631 0.000175428 … 0.000173251 0.000171386; 0.000180631 0.000181026 … 0.000176782 0.00017427]

[0.000138567 0.00014051 … 0.000146051 0.000146952; 0.000144836 0.000146505 … 0.000150373 0.000150698; … ; 0.000167115 0.000167444 … 0.000163892 0.000161799; 0.000172211 0.000172134 … 0.000166509 0.000163774]

[0.000134468 0.000135823 … 0.00013969 0.000140319; 0.000139847 0.000140951 … 0.000143213 0.00014328; … ; 0.0001584 0.000158207 … 0.000153202 0.000150896; 0.000162477 0.000161882 … 0.000154834 0.0001519]

[0.000132133 0.000133154 … 0.000136067 0.000136541; 0.000136998 0.000137782 … 0.000139142 0.000139068; … ; 0.000153441 0.000152963 … 0.000147205 0.000144803; 0.000156954 0.00015608 … 0.000148312 0.000145296]

...

[7.76957e-5 7.68683e-5 … 7.67085e-5 7.75777e-5; 8.17679e-5 8.06945e-5 … 7.95665e-5 8.0162e-5; … ; 0.000100645 9.83624e-5 … 9.2347e-5 9.15596e-5; 0.000106326 0.000103653 … 9.60258e-5 9.47851e-5]

[8.06194e-5 7.98929e-5 … 7.97379e-5 8.05092e-5; 8.45736e-5 8.36273e-5 … 8.26183e-5 8.31478e-5; … ; 0.000102564 0.000100491 … 9.50236e-5 9.43065e-5; 0.000107905 0.000105458 … 9.84756e-5 9.73398e-5]

[8.72271e-5 8.67379e-5 … 8.66684e-5 8.72468e-5; 9.08944e-5 9.02415e-5 … 8.95614e-5 8.99658e-5; … ; 0.000106853 0.000105252 … 0.000101018 0.000100463; 0.000111433 0.00010949 … 0.000103949 0.000103048]

[9.50445e-5 9.48521e-5 … 9.50135e-5 9.54132e-5; 9.83362e-5 9.80405e-5 … 9.78524e-5 9.81507e-5; … ; 0.000111842 0.00011079 … 0.000108011 0.000107652; 0.000115532 0.000114177 … 0.00011031 0.000109681]

[9.9569e-5 9.95559e-5 … 9.99141e-5 0.000100235; 0.000102625 0.00010254 … 0.000102687 0.000102944; … ; 0.000114686 0.000113948 … 0.000112006 0.000111763; 0.000117867 0.000116846 … 0.000113933 0.000113459]

[8.76532e-5 8.53516e-5 … 7.88062e-5 7.76957e-5; 9.30095e-5 9.05188e-5 … 8.31213e-5 8.1768e-5; … ; 0.000117627 0.000114383 … 0.000103168 0.000100645; 0.000125 0.00012156 … 0.000109219 0.000106326]

[8.93164e-5 8.7298e-5 … 8.15898e-5 8.06195e-5; 9.44588e-5 9.22599e-5 … 8.5763e-5 8.45736e-5; … ; 0.000117984 0.000115035 … 0.000104853 0.000102564; 0.000125 0.000121851 … 0.000110553 0.000107905]

[9.30985e-5 9.17088e-5 … 8.78759e-5 8.7227e-5; 9.77483e-5 9.61969e-5 … 9.17111e-5 9.08943e-5; … ; 0.000118788 0.000116497 … 0.000108622 0.000106853; 0.000125 0.000122501 … 0.000113534 0.000111433]

[9.7618e-5 9.69515e-5 … 9.53047e-5 9.50444e-5; 0.000101668 0.00010086 … 9.87093e-5 9.83361e-5; … ; 0.000119735 0.000118206 … 0.000113004 0.000111842; 0.000125 0.000123256 … 0.000116999 0.000115532]

[0.000100259 0.0001 … 9.96007e-5 9.95689e-5; 0.000103952 0.000103564 … 0.00010274 0.000102625; … ; 0.000120282 0.000119186 … 0.000115503 0.000114686; 0.000125 0.000123686 … 0.000118972 0.000117867]

[8.3098e-5 8.00005e-5 … 7.11259e-5 6.96367e-5; 8.90313e-5 8.572e-5 … 7.58092e-5 7.40072e-5; … ; 0.00011664 0.000112569 … 9.84643e-5 9.52916e-5; 0.000125 0.000120748 … 0.000105494 0.000101918]

[8.32362e-5 8.01633e-5 … 7.13603e-5 6.98825e-5; 8.91522e-5 8.58663e-5 … 7.60328e-5 7.42445e-5; … ; 0.00011667 0.000112625 … 9.8609e-5 9.54563e-5; 0.000125 0.000120773 … 0.000105608 0.000102054]

[8.42533e-5 8.13605e-5 … 7.30816e-5 7.16877e-5; 9.00415e-5 8.69413e-5 … 7.76744e-5 7.59861e-5; … ; 0.000116892 0.000113033 … 9.96693e-5 9.66631e-5; 0.000125 0.000120956 … 0.000106448 0.000103048]

[8.62349e-5 8.36886e-5 … 7.64238e-5 7.51946e-5; 9.17722e-5 8.90294e-5 … 8.08568e-5 7.93637e-5; … ; 0.000117321 0.000113822 … 0.000101717 9.89939e-5; 0.000125 0.00012131 … 0.00010807 0.000104967]

[8.76532e-5 8.53516e-5 … 7.88062e-5 7.76957e-5; 9.30095e-5 9.05188e-5 … 8.31214e-5 8.1768e-5; … ; 0.000117627 0.000114383 … 0.000103168 0.000100645; 0.000125 0.00012156 … 0.000109219 0.000106326], ξx = [20.0 19.342 … 17.3003 16.8825; 19.9997 19.3637 … 17.3727 16.9599; … ; 19.9987 19.4404 … 17.6404 17.2509; 19.9985 19.4575 … 17.7029 17.3202]

[20.0 19.3458 … 17.314 16.898; 19.9999 19.3671 … 17.3851 16.974; … ; 19.9996 19.4433 … 17.6493 17.2611; 19.9996 19.4603 … 17.7113 17.3298]

[20.0 19.3732 … 17.4153 17.0123; 19.9998 19.3911 … 17.4756 17.0768; … ; 19.9991 19.4577 … 17.7089 17.3307; 19.999 19.4734 … 17.7662 17.3942]

[20.0 19.4265 … 17.6144 17.2374; 19.9999 19.438 … 17.6542 17.2804; … ; 19.9996 19.4878 … 17.8295 17.4713; 19.9996 19.501 … 17.8778 17.5248]

[20.0 19.4643 … 17.7581 17.4005; 19.9997 19.4714 … 17.7835 17.4282; … ; 19.9987 19.5086 … 17.9171 17.5739; 19.9985 19.5198 … 17.9587 17.62]

[20.0 19.4643 … 17.7581 17.4005; 19.9998 19.4715 … 17.7836 17.4282; … ; 19.999 19.5088 … 17.9173 17.5741; 19.9988 19.5202 … 17.959 17.6203]

[20.0 19.5085 … 17.928 17.5939; 19.9999 19.511 … 17.9375 17.6044; … ; 19.9995 19.5352 … 18.0243 17.6992; 19.9994 19.5446 … 18.0584 17.7368]

[20.0 19.6079 … 18.3196 18.0418; 19.9998 19.6006 … 18.2945 18.015; … ; 19.9992 19.5959 … 18.2777 17.9964; 19.9991 19.6005 … 18.2943 18.0145]

[20.0 19.7248 … 18.7968 18.5918; 19.9999 19.7078 … 18.735 18.5249; … ; 19.9995 19.673 … 18.6036 18.3799; 19.9994 19.6723 … 18.5998 18.3751]

[20.0 19.7919 … 19.0799 18.9204; 19.9998 19.7702 … 18.9991 18.8324; … ; 19.999 19.7194 … 18.8056 18.6185; 19.9988 19.7157 … 18.7901 18.6005]

[17.4005 17.0827 … 16.2365 16.1067; 17.4283 17.1119 … 16.2612 16.1274; … ; 17.5744 17.2662 … 16.4034 16.2564; 17.6206 17.3156 … 16.4544 16.3054]

[17.5939 17.296 … 16.499 16.3762; 17.6044 17.3077 … 16.5108 16.3867; … ; 17.6994 17.4085 … 16.6074 16.476; 17.7372 17.4489 … 16.6489 16.516]

[18.0418 17.7924 … 17.1173 17.0123; 18.0151 17.7657 … 17.1006 16.9999; … ; 17.9967 17.7477 … 17.0956 17.0016; 18.0149 17.7671 … 17.1157 17.0217]

[18.5918 18.4063 … 17.8967 17.8165; 18.525 18.3378 … 17.8482 17.7786; … ; 18.3802 18.1866 … 17.73 17.6843; 18.3754 18.1812 … 17.7256 17.682]

[18.9204 18.7753 … 18.3733 18.3095; 18.8324 18.6846 … 18.3074 18.2578; … ; 18.6188 18.4605 … 18.1277 18.1121; 18.6008 18.4408 … 18.1096 18.0975]

...

[23.5396 24.1552 … 26.0498 26.3484; 23.5759 24.1956 … 26.1043 26.4099; … ; 23.5529 24.1652 … 26.084 26.4172; 23.5126 24.119 … 26.0347 26.3755]

[23.0313 23.5661 … 25.2782 25.5741; 23.0858 23.6247 … 25.3377 25.6337; … ; 23.1753 23.7152 … 25.4028 25.6978; 23.1685 23.7062 … 25.387 25.6832]

[22.0211 22.3981 … 23.7316 24.0076; 22.103 22.4843 … 23.7998 24.0658; … ; 22.3818 22.7765 … 24.0091 24.2294; 22.4351 22.8331 … 24.0503 24.2606]

[21.0242 21.2502 … 22.1907 22.4286; 21.1217 21.352 … 22.2652 22.4874; … ; 21.5373 21.7877 … 22.5802 22.7286; 21.639 21.8959 … 22.6635 22.7934]

[20.529 20.6813 … 21.4182 21.6298; 20.6292 20.7858 … 21.4941 21.6888; … ; 21.0901 21.2682 … 21.8449 21.9578; 21.2103 21.3957 … 21.9428 22.0344]

[20.0014 20.5664 … 22.9061 23.5398; 20.0011 20.5731 … 22.9378 23.5761; … ; 20.0002 20.5722 … 22.923 23.5529; 20.0 20.566 … 22.8898 23.5126]

[20.0004 20.4861 … 22.4859 23.0315; 20.0004 20.4969 … 22.5343 23.086; … ; 20.0001 20.5172 … 22.618 23.1753; 20.0 20.5169 … 22.6135 23.1685]

[20.0008 20.3221 … 21.6467 22.0212; 20.0007 20.3394 … 21.7206 22.1031; … ; 20.0002 20.3974 … 21.9722 22.3819; 20.0 20.4081 … 22.0197 22.4351]

[20.0003 20.151 … 20.8131 21.0243; 20.0002 20.1726 … 20.9016 21.1218; … ; 20.0001 20.2622 … 21.2771 21.5374; 20.0 20.283 … 21.3677 21.639]

[20.001 20.0634 … 20.3971 20.5291; 20.0009 20.0861 … 20.4884 20.6293; … ; 20.0002 20.1873 … 20.9057 21.0901; 20.0 20.2125 … 21.0133 21.2103]

[20.0018 20.8095 … 24.249 25.1765; 20.0015 20.8012 … 24.2118 25.137; … ; 20.0003 20.7288 … 23.8303 24.6882; 20.0 20.7043 … 23.6981 24.5296]

[20.0005 20.8002 … 24.2021 25.1192; 20.0004 20.7927 … 24.1678 25.083; … ; 20.0001 20.7237 … 23.8009 24.6511; 20.0 20.7 … 23.6724 24.4969]

[20.0012 20.7435 … 23.8777 24.7222; 20.001 20.7398 … 23.8619 24.7064; … ; 20.0002 20.6881 … 23.5894 24.3851; 20.0 20.6687 … 23.4856 24.2606]

[20.0004 20.6368 … 23.2904 24.0065; 20.0004 20.6397 … 23.3049 24.024; … ; 20.0001 20.6197 … 23.1934 23.8895; 20.0 20.6084 … 23.1331 23.817]

[20.0016 20.5666 … 22.9063 23.54; 20.0014 20.5733 … 22.938 23.5763; … ; 20.0003 20.5722 … 22.923 23.553; 20.0 20.566 … 22.8898 23.5126], ηx = [0.0 -0.658658 … -2.79243 -3.27661; 0.0 -0.634174 … -2.69966 -3.17062; … ; 0.0 -0.497275 … -2.14806 -2.53122; 0.0 -0.452598 … -1.96164 -2.31343]

[0.0 -0.655117 … -2.77908 -3.26136; 0.0 -0.63111 … -2.68792 -3.15713; … ; 0.0 -0.495716 … -2.14179 -2.52387; 0.0 -0.451337 … -1.95653 -2.30743]

[0.0 -0.627509 … -2.67375 -3.14059; 0.0 -0.607053 … -2.59471 -3.04969; … ; 0.0 -0.483076 … -2.09035 -2.46354; 0.0 -0.44101 … -1.91417 -2.25755]

[0.0 -0.57432 … -2.46831 -2.90446; 0.0 -0.560452 … -2.4122 -2.83885; … ; 0.0 -0.458106 … -1.98802 -2.34328; 0.0 -0.420506 … -1.82947 -2.15766]

[0.0 -0.536183 … -2.31869 -2.73193; 0.0 -0.526796 … -2.27856 -2.68401; … ; 0.0 -0.439566 … -1.91129 -2.25292; 0.0 -0.405169 … -1.76551 -2.08206]

[0.0 -0.536238 … -2.31893 -2.73221; 0.0 -0.526847 … -2.27879 -2.68428; … ; 0.0 -0.439602 … -1.91146 -2.25311; 0.0 -0.405201 … -1.76565 -2.08224]

[0.0 -0.492124 … -2.14366 -2.52957; 0.0 -0.487698 … -2.12161 -2.50175; … ; 0.0 -0.417605 … -1.81974 -2.1449; 0.0 -0.386915 … -1.68884 -1.99128]

[0.0 -0.392473 … -1.73809 -2.05825; 0.0 -0.398266 … -1.75477 -2.07378; … ; 0.0 -0.365218 … -1.59799 -1.88234; 0.0 -0.342893 … -1.50119 -1.7683]

[0.0 -0.275544 … -1.24465 -1.48031; 0.0 -0.291551 … -1.30262 -1.54257; … ; 0.0 -0.298743 … -1.31005 -1.5396; 0.0 -0.28616 … -1.25392 -1.47296]

[0.0 -0.208144 … -0.95114 -1.13414; 0.0 -0.229111 … -1.03045 -1.22082; … ; 0.0 -0.257673 … -1.12847 -1.32248; 0.0 -0.25063 … -1.09601 -1.28352]

[-2.73221 -3.12599 … -4.48057 -4.81094; -2.68428 -3.07007 … -4.38995 -4.70953; … ; -2.25311 -2.57774 … -3.67675 -3.93765; -2.08224 -2.38323 … -3.40215 -3.64347]

[-2.52957 -2.89809 … -4.16904 -4.47894; -2.50175 -2.86374 … -4.10128 -4.39976; … ; -2.1449 -2.45319 … -3.48675 -3.72825; -1.99128 -2.27809 … -3.23816 -3.46141]

[-2.05825 -2.36557 … -3.43209 -3.69208; -2.07378 -2.37799 … -3.41376 -3.66057; … ; -1.88234 -2.14997 … -3.01909 -3.21161; -1.7683 -2.01948 … -2.83027 -3.00746]

[-1.48031 -1.70798 … -2.50455 -2.69879; -1.54257 -1.77122 … -2.53973 -2.71816; … ; -1.5396 -1.75219 … -2.39571 -2.5207; -1.47296 -1.67528 … -2.27853 -2.39133]

[-1.13414 -1.31164 … -1.93586 -2.08814; -1.22082 -1.40165 … -1.99909 -2.13378; … ; -1.32248 -1.49915 … -1.99414 -2.07462; -1.28352 -1.45358 … -1.91874 -1.98865]

...

[-3.23356 -3.89405 … -6.50538 -7.16583; -3.43061 -4.12482 … -6.85189 -7.53999; … ; -3.72869 -4.46136 … -7.28282 -7.9896; -3.69287 -4.41463 … -7.1854 -7.87891]

[-2.75336 -3.32287 … -5.64028 -6.24978; -2.95043 -3.55101 … -5.96327 -6.59219; … ; -3.33253 -3.97916 … -6.46367 -7.08867; -3.33205 -3.97324 … -6.41587 -7.02522]

[-1.80032 -2.1937 … -3.92135 -4.41723; -1.98758 -2.40619 … -4.19256 -4.6945; … ; -2.49769 -2.97077 … -4.7864 -5.2489; -2.56046 -3.03685 … -4.82314 -5.26594]

[-0.871642 -1.09915 … -2.24569 -2.61552; -1.0352 -1.28146 … -2.45716 -2.82362; … ; -1.6113 -1.91144 … -3.07451 -3.3781; -1.72397 -2.03291 … -3.1726 -3.45348]

[-0.412933 -0.560643 … -1.41832 -1.72047; -0.558758 -0.72166 … -1.59547 -1.89075; … ; -1.14104 -1.35412 … -2.19393 -2.41854; -1.27245 -1.49582 … -2.31291 -2.51374]

[0.0 -0.485249 … -2.60032 -3.23356; 0.0 -0.517015 … -2.76274 -3.43061; … ; 0.0 -0.570377 … -3.01632 -3.72869; 0.0 -0.566769 … -2.98988 -3.69287]

[0.0 -0.414481 … -2.21152 -2.75336; 0.0 -0.447351 … -2.37558 -2.95043; … ; 0.0 -0.515885 … -2.70198 -3.33253; 0.0 -0.517749 … -2.70477 -3.33205]

[0.0 -0.268167 … -1.43539 -1.80032; 0.0 -0.301577 … -1.59407 -1.98758; … ; 0.0 -0.3962 … -2.03407 -2.49769; 0.0 -0.408688 … -2.09003 -2.56046]

[0.0 -0.117534 … -0.67323 -0.871643; 0.0 -0.148816 … -0.81411 -1.0352; … ; 0.0 -0.261468 … -1.31676 -1.6113; 0.0 -0.283553 … -1.41581 -1.72397]

[0.0 -0.0399568 … -0.294582 -0.412933; 0.0 -0.0689347 … -0.421283 -0.558758; … ; 0.0 -0.18652 … -0.932704 -1.14104; 0.0 -0.212781 … -1.04844 -1.27245]

[0.0 -0.703059 … -3.85509 -4.79583; 0.0 -0.728337 … -3.9946 -4.97247; … ; 0.0 -0.726535 … -3.95448 -4.92342; 0.0 -0.705209 … -3.82586 -4.76166]

[0.0 -0.696152 … -3.81373 -4.74399; 0.0 -0.721715 … -3.95444 -4.92184; … ; 0.0 -0.721879 … -3.92549 -4.88617; 0.0 -0.701138 … -3.80043 -4.72885]

[0.0 -0.644382 … -3.50806 -4.36184; 0.0 -0.671854 … -3.65649 -4.54714; … ; 0.0 -0.686079 … -3.70586 -4.60495; 0.0 -0.669635 … -3.60648 -4.47959]

[0.0 -0.549383 … -2.96038 -3.67988; 0.0 -0.579721 … -3.11894 -3.87423; … ; 0.0 -0.618134 … -3.2971 -4.08426; 0.0 -0.609439 … -3.24246 -4.01404]

[0.0 -0.485178 … -2.59996 -3.23312; 0.0 -0.516944 … -2.76237 -3.43016; … ; 0.0 -0.570314 … -3.01599 -3.72828; 0.0 -0.566711 … -2.98957 -3.69249], ζx = [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0]

[-0.681064 -0.655117 … -0.511868 -0.465488; -0.655012 -0.63111 … -0.501261 -0.459229; … ; -0.511581 -0.495716 … -0.414887 -0.388926; -0.465208 -0.451337 … -0.381914 -0.359712]

[-1.96499 -1.89281 … -1.48548 -1.3521; -1.89049 -1.82373 … -1.45365 -1.3326; … ; -1.47815 -1.43335 … -1.2014 -1.12625; -1.34448 -1.30524 … -1.10581 -1.04147]

[-3.22819 -3.11815 … -2.46831 -2.25071; -3.10792 -3.00532 … -2.4122 -2.21409; … ; -2.43535 -2.3649 … -1.98802 -1.86375; -2.21614 -2.15424 … -1.82947 -1.72286]

[-3.88166 -3.75666 … -2.99219 -2.73193; -3.73891 -3.62164 … -2.92151 -2.68401; … ; -2.93441 -2.85249 … -2.40306 -2.25292; -2.67117 -2.59902 … -2.21109 -2.08206]

[-3.88166 -3.75666 … -2.99219 -2.73193; -3.73891 -3.62164 … -2.92151 -2.68401; … ; -2.93441 -2.85249 … -2.40306 -2.25292; -2.67117 -2.59902 … -2.21109 -2.08206]

[-4.52373 -4.38799 … -3.5205 -3.21921; -4.35992 -4.23161 … -3.43384 -3.15812; … ; -3.42821 -3.33665 … -2.81818 -2.6422; -3.12191 -3.04102 … -2.59257 -2.44104]

[-5.70287 -5.55994 … -4.53511 -4.16165; -5.50381 -5.36606 … -4.41417 -4.07004; … ; -4.34646 -4.24277 … -3.60538 -3.38054; -3.96179 -3.86946 … -3.31532 -3.12075]

[-6.82181 -6.69047 … -5.56627 -5.13001; -6.59467 -6.46428 … -5.40635 -5.0006; … ; -5.23589 -5.12975 … -4.39295 -4.11945; -4.77799 -4.6824 … -4.03731 -3.799]

[-7.38379 -7.26629 … -6.11557 -5.65077; -7.14506 -7.02571 … -5.93376 -5.49888; … ; -5.6912 -5.5883 … -4.80848 -4.50944; -5.19709 -5.10366 … -4.41774 -4.15601]

[-2.73221 -2.45607 … -1.29277 -0.96548; -2.68428 -2.43175 … -1.35406 -1.04547; … ; -2.25311 -2.09239 … -1.37402 -1.15468; -2.08224 -1.94396 … -1.31897 -1.12513]

[-3.21954 -2.89809 … -1.531 -1.14404; -3.15844 -2.86374 … -1.59476 -1.22926; … ; -2.64243 -2.45319 … -1.60004 -1.33799; -2.44125 -2.27809 … -1.53408 -1.30186]

[-4.16208 -3.75839 … -2.00247 -1.49835; -4.07044 -3.69808 … -2.06019 -1.58201; … ; -3.38084 -3.13641 … -2.01196 -1.66181; -3.12102 -2.90918 … -1.92282 -1.6105]

[-5.13054 -4.65099 … -2.50455 -1.87719; -5.0011 -4.55511 … -2.53973 -1.94135; … ; -4.11984 -3.81831 … -2.39571 -1.94536; -3.79935 -3.53619 … -2.27853 -1.87342]

[-5.65135 -5.13509 … -2.78313 -2.08814; -5.49945 -5.01675 … -2.799 -2.13378; … ; -4.50987 -4.17729 … -2.5839 -2.07462; -4.1564 -3.8648 … -2.44918 -1.98865]

...

[-3.23356 -2.88772 … -1.08 -0.529989; -3.43061 -3.09226 … -1.2794 -0.715332; … ; -3.72869 -3.47488 … -1.95146 -1.42925; -3.69287 -3.46874 … -2.07417 -1.58232]

[-3.71286 -3.32287 … -1.30749 -0.693279; -3.93563 -3.55101 … -1.52066 -0.889973; … ; -4.2786 -3.97916 … -2.22859 -1.63615; -4.24066 -3.97324 … -2.35705 -1.79558]

[-4.5372 -4.07866 … -1.767 -1.0615; -4.80039 -4.34068 … -1.98852 -1.26145; … ; -5.21637 -4.83059 … -2.69149 -1.98644; -5.17656 -4.82419 … -2.81475 -2.13802]

[-5.25036 -4.74153 … -2.24569 -1.48522; -5.54405 -5.02523 … -2.45716 -1.66921; … ; -6.01335 -5.54383 … -3.07451 -2.28268; -5.97222 -5.53358 … -3.1726 -2.40258]

[-5.58315 -5.0541 … -2.4977 -1.72047; -5.88961 -5.34546 … -2.69889 -1.89075; … ; -6.37848 -5.86679 … -3.24676 -2.41854; -6.33597 -5.85243 … -3.32459 -2.51374]

[-3.81008 -3.88419 … -3.51124 -3.23312; -3.95657 -4.03694 … -3.69909 -3.43016; … ; -3.98854 -4.07769 … -3.91902 -3.72828; -3.88238 -3.97003 … -3.85777 -3.69249]

[-4.42224 -4.49215 … -4.02983 -3.71237; -4.59575 -4.67295 … -4.24503 -3.93512; … ; -4.64531 -4.73665 … -4.50748 -4.27814; -4.5245 -4.6156 … -4.44154 -4.24022]

[-5.52306 -5.56873 … -4.91924 -4.53663; -5.74967 -5.80398 … -5.18051 -4.79981; … ; -5.84748 -5.92806 … -5.52234 -5.21581; -5.70364 -5.78761 … -5.45201 -5.17602]

[-6.53232 -6.53524 … -5.6852 -5.24974; -6.81443 -6.82605 … -5.98504 -5.54341; … ; -6.98216 -7.03208 … -6.3992 -6.01271; -6.82245 -6.88048 … -6.32833 -5.9716]

[-7.02316 -6.9979 … -6.04118 -5.58252; -7.33537 -7.31816 … -6.35863 -5.88895; … ; -7.54919 -7.57539 … -6.80641 -6.3778; -7.38431 -7.42121 … -6.73587 -6.33531]

[0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0]

[-0.675728 -0.696152 … -0.644296 -0.592576; -0.700298 -0.721715 … -0.678815 -0.630257; … ; -0.700993 -0.721879 … -0.713498 -0.68339; -0.681219 -0.701138 … -0.700046 -0.675031]

[-1.9448 -1.99846 … -1.83876 -1.69158; -2.01644 -2.07309 … -1.9373 -1.79809; … ; -2.02171 -2.0784 … -2.0406 -1.95128; -1.96542 -2.01983 … -2.0038 -1.92878]

[-3.17965 -3.25192 … -2.96038 -2.72484; -3.29977 -3.37717 … -3.11894 -2.89316; … ; -3.31887 -3.40082 … -3.2971 -3.14316; -3.22883 -3.30854 … -3.24246 -3.11068]

[-3.81008 -3.88419 … -3.51124 -3.23312; -3.95657 -4.03694 … -3.69909 -3.43016; … ; -3.98854 -4.07769 … -3.91902 -3.72828; -3.88238 -3.97003 … -3.85777 -3.69249], ξy = [0.0 0.0 … 0.0 0.0; -0.658718 -0.634142 … -0.497233 -0.452634; … ; -2.79245 -2.69958 … -2.14792 -1.9616; -3.27657 -3.17055 … -2.53107 -2.31333]

[0.0 0.0 … 0.0 0.0; -0.655181 -0.63084 … -0.494857 -0.450498; … ; -2.77916 -2.68697 … -2.1378 -1.95211; -3.26138 -3.1561 … -2.51923 -2.30212]

[0.0 0.0 … 0.0 0.0; -0.627572 -0.604987 … -0.47606 -0.433564; … ; -2.67379 -2.58676 … -2.05699 -1.87628; -3.14058 -3.04089 … -2.42445 -2.21248]

[0.0 0.0 … 0.0 0.0; -0.574389 -0.555016 … -0.439354 -0.400428; … ; -2.46839 -2.39104 … -1.89822 -1.72714; -2.90448 -2.81535 … -2.23791 -2.03584]

[0.0 0.0 … 0.0 0.0; -0.536252 -0.51903 … -0.412573 -0.376189; … ; -2.31872 -2.24806 … -1.78142 -1.61729; -2.73188 -2.65008 … -2.10033 -1.90542]

[0.0 0.0 … 0.0 0.0; -0.53631 -0.519086 … -0.412619 -0.376231; … ; -2.31901 -2.24834 … -1.78166 -1.61752; -2.73223 -2.65042 … -2.10062 -1.9057]

[0.0 0.0 … 0.0 0.0; -0.492198 -0.477318 … -0.381203 -0.347737; … ; -2.14373 -2.08055 … -1.64374 -1.48763; -2.52957 -2.456 … -1.93784 -1.7512]

[0.0 0.0 … 0.0 0.0; -0.392553 -0.382351 … -0.308301 -0.281341; … ; -1.73817 -1.69073 … -1.31959 -1.18176; -2.05825 -2.00214 … -1.5538 -1.38605]

[0.0 0.0 … 0.0 0.0; -0.275629 -0.269817 … -0.219194 -0.199671; … ; -1.24472 -1.21336 … -0.915293 -0.799031; -1.48029 -1.44227 … -1.07204 -0.926623]

[0.0 0.0 … 0.0 0.0; -0.208232 -0.204397 … -0.165966 -0.150611; … ; -0.951232 -0.927768 … -0.669428 -0.565655; -1.13415 -1.10513 … -0.777589 -0.645167]

[0.0 0.0 … 0.0 0.0; -0.376259 -0.33747 … -0.174236 -0.128436; … ; -1.61785 -1.44174 … -0.693313 -0.482729; -1.90615 -1.69657 … -0.80224 -0.549944]

[0.0 0.0 … 0.0 0.0; -0.347764 -0.31192 … -0.159994 -0.117211; … ; -1.48798 -1.31995 … -0.603798 -0.402504; -1.75167 -1.55036 … -0.689026 -0.446378]

[0.0 0.0 … 0.0 0.0; -0.281369 -0.252175 … -0.126473 -0.0908233; … ; -1.18213 -1.03271 … -0.3928 -0.213991; -1.38655 -1.20433 … -0.421269 -0.202143]

[0.0 0.0 … 0.0 0.0; -0.199697 -0.178282 … -0.0845789 -0.0579001; … ; -0.799428 -0.6724 … -0.128406 0.0210415; -0.927168 -0.767988 … -0.084067 0.10399]

[0.0 0.0 … 0.0 0.0; -0.150636 -0.133679 … -0.059065 -0.0378853; … ; -0.566067 -0.452274 … 0.0325665 0.163312; -0.645735 -0.50024 … 0.122008 0.290023]

...

[-3.6518 -3.4824 … -2.30165 -1.85819; -2.9392 -2.79574 … -1.82033 -1.45884; … ; -0.542846 -0.511138 … -0.311439 -0.240538; -2.57779e-13 -4.50196e-13 … 8.45451e-13 -2.63544e-13]

[-3.29047 -3.15296 … -2.17148 -1.79324; -2.64754 -2.52723 … -1.70293 -1.39244; … ; -0.489497 -0.460303 … -0.28105 -0.218081; 1.69367e-12 -1.29966e-13 … -3.92308e-13 -3.64775e-12]

[-2.55418 -2.48201 … -1.8912 -1.64113; -2.04982 -1.97834 … -1.45458 -1.24479; … ; -0.37655 -0.353466 … -0.218265 -0.171654; -8.34416e-13 -3.92922e-13 … 1.43519e-13 -8.08042e-14]

[-1.80479 -1.79907 … -1.58243 -1.45521; -1.43703 -1.41711 … -1.18745 -1.07498; … ; -0.255739 -0.240331 … -0.153243 -0.123495; -7.35009e-13 9.73905e-13 … -1.03995e-12 3.54099e-12]

[-1.41838 -1.44656 … -1.41222 -1.34472; -1.11945 -1.1266 … -1.0429 -0.978194; … ; -0.191181 -0.180343 … -0.119316 -0.0983105; 5.29834e-13 3.3404e-13 … -2.6493e-12 -7.33893e-13]

[-3.69305 -3.77902 … -3.76685 -3.65256; -2.9899 -3.05993 … -3.03819 -2.93969; … ; -0.566695 -0.579615 … -0.565816 -0.54285; -1.34337e-12 5.57977e-13 … -2.09655e-13 -6.265e-13]

[-3.33227 -3.39867 … -3.38366 -3.29125; -2.70481 -2.75931 … -2.73115 -2.64805; … ; -0.517673 -0.52811 … -0.511085 -0.489502; 5.63871e-14 -9.21524e-14 … -9.74838e-13 -3.29986e-12]

[-2.56065 -2.59489 … -2.59997 -2.55499; -2.09006 -2.11851 … -2.09875 -2.05036; … ; -0.408606 -0.414508 … -0.394285 -0.37656; -2.16493e-13 -2.37904e-13 … 1.6196e-13 4.98159e-14]

[-1.72418 -1.73762 … -1.79904 -1.8056; -1.41584 -1.42679 … -1.44638 -1.43758; … ; -0.283467 -0.285788 … -0.267964 -0.255754; -1.97985e-12 7.34291e-13 … -2.11637e-13 2.40934e-12]

[-1.27261 -1.28061 … -1.38509 -1.41919; -1.04844 -1.05449 … -1.10691 -1.12; … ; -0.212692 -0.21374 … -0.199873 -0.191198; -1.69309e-12 -1.96353e-13 … -1.63306e-12 -2.5098e-27]

[-4.76195 -4.9235 … -4.97284 -4.79613; -3.82596 -3.95458 … -3.99494 -3.85516; … ; -0.705145 -0.726575 … -0.728421 -0.702969; -2.69229e-13 -5.3156e-14 … -9.20857e-14 -5.44666e-14]

[-4.729 -4.88774 … -4.93365 -4.75877; -3.80044 -3.92691 … -3.96414 -3.82549; … ; -0.701071 -0.722209 … -0.723413 -0.697994; 6.2888e-14 -2.8533e-14 … 3.30003e-14 -7.92635e-13]

[-4.47982 -4.61877 … -4.64344 -4.48274; -3.60654 -3.71784 … -3.73508 -3.60546; … ; -0.669568 -0.688593 … -0.685431 -0.660394; -4.41314e-13 -4.8762e-14 … -1.41779e-13 4.30955e-13]

[-4.0142 -4.12002 … -4.11744 -3.98394; -3.24247 -3.32808 … -3.31785 -3.20619; … ; -0.609366 -0.624665 … -0.614597 -0.590623; -6.01346e-13 3.37286e-13 … -2.44132e-13 5.32656e-13]

[-3.69279 -3.77876 … -3.76664 -3.65238; -2.98967 -3.0597 … -3.03799 -2.93951; … ; -0.566639 -0.579558 … -0.565761 -0.542798; -3.31679e-12 1.26294e-12 … -1.3977e-12 5.22084e-13], ηy = [19.9996 19.9994 … 19.999 19.9989; 19.3422 19.3638 … 19.4403 19.4574; … ; 17.3004 17.3728 … 17.6404 17.7029; 16.8822 16.9597 … 17.2512 17.3207]

[19.9996 19.9996 … 19.9998 19.9999; 19.346 19.3675 … 19.444 19.4611; … ; 17.3142 17.3861 … 17.6531 17.7157; 16.8977 16.9748 … 17.2659 17.3355]

[19.9996 19.9995 … 19.9993 19.9993; 19.3734 19.3932 … 19.4648 19.4811; … ; 17.4155 17.4833 … 17.7422 17.8046; 17.012 17.085 … 17.3695 17.4397]

[19.9996 19.9996 … 19.9998 19.9999; 19.4266 19.4436 … 19.507 19.522; … ; 17.6145 17.6748 … 17.9191 17.9814; 17.2371 17.3026 … 17.5755 17.647]

[19.9996 19.9994 … 19.9989 19.9989; 19.4645 19.4793 … 19.5363 19.5502; … ; 17.7582 17.8131 … 18.0468 18.1089; 17.4002 17.4603 … 17.7246 17.797]

[19.9996 19.9995 … 19.9992 19.9991; 19.4645 19.4793 … 19.5365 19.5504; … ; 17.7582 17.8132 … 18.047 18.1091; 17.4002 17.4604 … 17.7248 17.7972]

[19.9996 19.9996 … 19.9997 19.9998; 19.5087 19.5215 … 19.5727 19.5855; … ; 17.9281 17.9773 … 18.2001 18.2623; 17.5936 17.6478 … 17.9036 17.9773]

[19.9996 19.9995 … 19.9994 19.9994; 19.6081 19.6166 … 19.6545 19.665; … ; 18.3198 18.3566 … 18.5559 18.6183; 18.0415 18.0831 … 18.3205 18.3972]

[19.9996 19.9996 … 19.9997 19.9998; 19.7249 19.7296 … 19.755 19.763; … ; 18.797 18.8215 … 18.9982 19.0614; 18.5915 18.6203 … 18.8408 18.9219]

[19.9996 19.9995 … 19.9991 19.9991; 19.7921 19.795 … 19.814 19.8205; … ; 19.0801 19.0986 … 19.2645 19.3285; 18.9201 18.9425 … 19.1555 19.2392]

[19.9991 19.9991 … 19.9991 19.9992; 19.5504 19.5634 … 19.6027 19.6103; … ; 18.1092 18.1697 … 18.3741 18.42; 17.7972 17.8686 … 18.1186 18.1772]

[19.9998 19.9998 … 20.0 20.0001; 19.5855 19.5978 … 19.6363 19.6442; … ; 18.2623 18.3241 … 18.5428 18.5946; 17.9773 18.0514 … 18.323 18.3898]

[19.9994 19.9994 … 19.9995 19.9996; 19.665 19.6753 … 19.711 19.7193; … ; 18.6183 18.6828 … 18.9326 18.997; 18.3972 18.4775 … 18.7976 18.8825]

[19.9998 19.9998 … 20.0 20.0001; 19.763 19.7712 … 19.8028 19.8109; … ; 19.0614 19.1296 … 19.415 19.4931; 18.9218 19.01 … 19.388 19.4935]

[19.9991 19.999 … 19.999 19.9991; 19.8205 19.8275 … 19.8558 19.8634; … ; 19.3285 19.3987 … 19.7032 19.7882; 19.2392 19.3321 … 19.7425 19.8593]

...

[23.9583 23.9889 … 23.7959 23.6416; 23.2523 23.2719 … 23.0867 22.9531; … ; 20.6273 20.6264 … 20.57 20.5392; 20.0008 20.0009 … 20.0011 20.0011]

[23.569 23.6122 … 23.5368 23.4296; 22.9309 22.9582 … 22.8586 22.7615; … ; 20.5654 20.564 … 20.515 20.489; 20.0 19.9999 … 19.9996 19.9996]

[22.7755 22.8439 … 22.9821 22.9605; 22.2732 22.3169 … 22.376 22.3453; … ; 20.4364 20.4352 … 20.403 20.3862; 20.0004 20.0004 … 20.0004 20.0004]

[21.958 22.0498 … 22.3654 22.4147; 21.5912 21.6514 … 21.8462 21.8711; … ; 20.2966 20.2962 … 20.2811 20.2728; 19.9999 19.9998 … 19.9996 19.9996]

[21.5351 21.6377 … 22.0277 22.1064; 21.237 21.3056 … 21.5591 21.6075; … ; 20.2226 20.2232 … 20.2174 20.213; 20.0007 20.0007 … 20.0009 20.0009]

[23.5132 23.6013 … 23.9058 23.9583; 22.8895 22.965 … 23.2133 23.2523; … ; 20.5658 20.5812 … 20.6237 20.6273; 20.0004 20.0005 … 20.0008 20.0008]

[23.1691 23.2386 … 23.5109 23.569; 22.6133 22.6733 … 22.8899 22.9309; … ; 20.5167 20.5293 … 20.5629 20.5654; 20.0004 20.0004 … 20.0001 20.0]

[22.4356 22.4747 … 22.7044 22.7755; 22.0195 22.0537 … 22.2253 22.2732; … ; 20.4079 20.4156 … 20.4353 20.4364; 20.0004 20.0004 … 20.0004 20.0004]

[21.6395 21.6579 … 21.8723 21.958; 21.3675 21.3833 … 21.5339 21.5912; … ; 20.2828 20.2864 … 20.2959 20.2966; 20.0004 20.0003 … 20.0 19.9999]

[21.2108 21.2233 … 21.4415 21.5351; 21.0131 21.0234 … 21.174 21.237; … ; 20.2123 20.2144 … 20.2215 20.2226; 20.0004 20.0004 … 20.0006 20.0007]

[24.5302 24.6887 … 25.1368 25.1762; 23.6978 23.8302 … 24.2123 24.2497; … ; 20.7041 20.7287 … 20.8015 20.8099; 20.0004 20.0006 … 20.0011 20.0013]

[24.4976 24.6531 … 25.0941 25.1334; 23.6721 23.8021 … 24.1776 24.2146; … ; 20.6998 20.7238 … 20.7946 20.8025; 20.0004 20.0004 … 20.0 19.9999]

[24.2613 24.3987 … 24.8004 24.8425; 23.4853 23.6008 … 23.9406 23.9775; … ; 20.6685 20.6904 … 20.754 20.7608; 20.0004 20.0005 … 20.0006 20.0006]

[23.8177 23.924 … 24.2623 24.3101; 23.1328 23.2232 … 23.5039 23.5413; … ; 20.6082 20.6261 … 20.6759 20.6805; 20.0004 20.0003 … 20.0 19.9998]

[23.5132 23.6013 … 23.9061 23.9588; 22.8895 22.965 … 23.2137 23.2527; … ; 20.5658 20.5813 … 20.624 20.6277; 20.0004 20.0006 … 20.0011 20.0012], ζy = [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0]

[-2.8355e-5 -3.25232e-5 … -4.54518e-5 -4.80939e-5; 0.0214695 0.0280415 … 0.0487554 0.0530976; … ; 0.0711035 0.0959776 … 0.179047 0.197963; 0.0758603 0.10414 … 0.199948 0.222173]

[-7.82649e-5 -9.05347e-5 … -0.000128817 -0.000136683; 0.0593649 0.0785409 … 0.139278 0.152067; … ; 0.197696 0.270428 … 0.513911 0.569499; 0.211161 0.293887 … 0.57471 0.64001]

[-0.000117334 -0.000138221 … -0.000204141 -0.00021783; 0.0893063 0.121467 … 0.224315 0.246162; … ; 0.300635 0.423209 … 0.835518 0.930131; 0.321829 0.461373 … 0.936979 1.04809]

[-0.000131512 -0.000157206 … -0.000238965 -0.000256072; 0.100343 0.139552 … 0.265806 0.292795; … ; 0.340418 0.49045 … 0.996908 1.11355; 0.365005 0.535939 … 1.12026 1.25722]

[-0.000131512 -0.000157206 … -0.000238965 -0.000256072; 0.100343 0.139552 … 0.265806 0.292795; … ; 0.340418 0.49045 … 0.996908 1.11355; 0.365005 0.535939 … 1.12026 1.25722]

[-0.000140305 -0.000170982 … -0.000269537 -0.000290343; 0.107359 0.153752 … 0.304362 0.336799; … ; 0.367559 0.546009 … 1.15096 1.2909; 0.39486 0.598373 … 1.29655 1.46084]

[-0.000140372 -0.000180854 … -0.000313772 -0.000342407; 0.108106 0.168415 … 0.3679 0.411606; … ; 0.377921 0.613121 … 1.41853 1.60672; 0.407792 0.676729 … 1.60724 1.8282]

[-0.000117172 -0.000167576 … -0.000337412 -0.000374901; 0.0909275 0.16529 … 0.416888 0.473173; … ; 0.325956 0.621676 … 1.64745 1.8901; 0.353635 0.69305 … 1.8804 2.16549]

[-9.55411e-5 -0.000151036 … -0.000340857 -0.000383359; 0.0744676 0.156152 … 0.436236 0.499673; … ; 0.270923 0.599907 … 1.7502 2.02434; 0.294882 0.673427 … 2.00679 2.32908]

[-0.000256063 -0.000271333 … -0.00031188 -0.00031806; 0.292782 0.317151 … 0.384708 0.395925; … ; 1.11348 1.22319 … 1.56882 1.63956; 1.25713 1.38708 … 1.80719 1.89632]

[-0.000290332 -0.000308952 … -0.000358649 -0.00036626; 0.336783 0.36614 … 0.447871 0.461485; … ; 1.29082 1.42265 … 1.83973 1.92544; 1.46074 1.61688 … 2.12393 2.23201]

[-0.000342393 -0.000368177 … -0.000437826 -0.000448605; 0.411586 0.451354 … 0.563165 0.581921; … ; 1.60662 1.78459 … 2.35256 2.4702; 1.82808 2.03887 … 2.7298 2.87843]

[-0.000374884 -0.0004089 … -0.000502158 -0.00051678; 0.473147 0.524703 … 0.671391 0.696195; … ; 1.88998 2.12048 … 2.86305 3.01792; 2.16535 2.43852 … 3.34281 3.53895]

[-0.000383339 -0.000422082 … -0.00052925 -0.000546186; 0.499644 0.557983 … 0.725149 0.753546; … ; 2.02421 2.28529 … 3.13055 3.30731; 2.32892 2.6385 … 3.66863 3.89282]

...

[-1.33201 -1.64884 … -2.50898 -2.61738; -1.04232 -1.30233 … -2.02834 -2.12673; … ; -0.174666 -0.223691 … -0.374781 -0.400353; 3.67729e-5 6.58441e-5 … 0.000157641 0.000173952]

[-1.57446 -1.92892 … -2.89657 -3.02276; -1.24024 -1.5316 … -2.34632 -2.4592; … ; -0.212544 -0.268233 … -0.4383 -0.466922; 5.72405e-5 9.07842e-5 … 0.000195597 0.000214046]

[-2.03864 -2.44759 … -3.57639 -3.7334; -1.62723 -1.96438 … -2.90992 -3.04667; … ; -0.29178 -0.357987 … -0.556396 -0.589401; 0.000110819 0.000151907 … 0.00027749 0.000299163]

[-2.49848 -2.94149 … -4.17726 -4.35953; -2.02077 -2.38689 … -3.41663 -3.57169; … ; -0.379398 -0.453213 … -0.670113 -0.705764; 0.000182754 0.000229806 … 0.000370293 0.000394038]

[-2.73468 -3.18852 … -4.46078 -4.65358; -2.22672 -2.60219 … -3.65952 -3.82179; … ; -0.428088 -0.504764 … -0.727765 -0.76419; 0.000227063 0.000276521 … 0.000422372 0.000446755]

[0.703512 0.361472 … -0.992957 -1.33209; 0.59186 0.32019 … -0.766337 -1.0424; … ; 0.113133 0.0665744 … -0.124056 -0.174685; -0.000131525 -0.000104412 … 6.93919e-6 3.67855e-5]

[0.736585 0.342174 … -1.19435 -1.57455; 0.621753 0.307265 … -0.930013 -1.24033; … ; 0.120334 0.0657466 … -0.154766 -0.212567; -0.00014032 -0.000108095 … 2.26439e-5 5.72549e-5]

[0.707034 0.223754 … -1.59835 -2.03876; 0.601145 0.212544 … -1.26607 -1.62735; … ; 0.119582 0.0501374 … -0.222361 -0.291808; -0.000140392 -9.82956e-5 … 6.79879e-5 0.000110837]

[0.562906 0.00747579 … -2.01977 -2.49864; 0.482489 0.0317434 … -1.62626 -2.02091; … ; 0.0990365 0.015671 … -0.301134 -0.37943; -0.000117195 -6.53953e-5 … 0.000133134 0.000182774]

[0.446946 -0.139018 … -2.24338 -2.73486; 0.384811 -0.0930748 … -1.82098 -2.22688; … ; 0.0803939 -0.00973633 … -0.34631 -0.428122; -9.55663e-5 -3.89172e-5 … 0.00017458 0.000227084]

[0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0]

[0.159727 0.0984509 … -0.156704 -0.222994; 0.133127 0.0849838 … -0.117388 -0.170889; … ; 0.0245917 0.0166073 … -0.0173514 -0.0267148; -2.83573e-5 -2.39049e-5 … -4.99096e-6 2.57607e-7]

[0.435556 0.259417 … -0.464866 -0.651296; 0.363828 0.225084 … -0.35098 -0.501776; … ; 0.0677492 0.0445692 … -0.0531296 -0.0798273; -7.82716e-5 -6.52022e-5 … -1.0124e-5 5.03503e-6]

[0.637988 0.351259 … -0.801275 -1.09302; 0.535169 0.308206 … -0.613192 -0.850092; … ; 0.101199 0.0627177 … -0.0967172 -0.139556; -0.000117345 -9.52189e-5 … -3.37781e-6 2.15078e-5]

[0.703512 0.361472 … -0.992956 -1.33209; 0.59186 0.32019 … -0.766337 -1.0424; … ; 0.113133 0.0665744 … -0.124056 -0.174685; -0.000131525 -0.000104412 … 6.93919e-6 3.67855e-5], ξz = [0.0 0.0 … 0.0 0.0; 1.08663e-9 -1.60025e-6 … -6.84343e-6 -8.0514e-6; … ; 4.12034e-9 -6.12977e-6 … -3.00948e-5 -3.74968e-5; 4.71824e-9 -7.03502e-6 … -3.55937e-5 -4.48637e-5]

[0.0 0.0 … 0.0 0.0; -4.92388e-6 0.00724223 … 0.0300385 0.0348214; … ; -1.86853e-5 0.0276209 … 0.11869 0.139437; -2.13989e-5 0.0316674 … 0.13715 0.161605]

[0.0 0.0 … 0.0 0.0; -1.4075e-5 0.0207276 … 0.0862981 0.100116; … ; -5.37083e-5 0.0794521 … 0.34218 0.402174; -6.15779e-5 0.0911889 … 0.395744 0.466503]

[0.0 0.0 … 0.0 0.0; -2.27043e-5 0.0335159 … 0.140583 0.163342; … ; -8.7577e-5 0.129748 … 0.561317 0.660343; -0.000100634 0.149228 … 0.650304 0.767235]

[0.0 0.0 … 0.0 0.0; -2.69301e-5 0.0398222 … 0.167932 0.195335; … ; -0.000104686 0.155264 … 0.673914 0.793336; -0.000120488 0.178847 … 0.781727 0.922859]

[0.0 0.0 … 0.0 0.0; -2.69283e-5 0.0398196 … 0.167921 0.195322; … ; -0.000104679 0.155254 … 0.673868 0.79328; -0.00012048 0.178835 … 0.781673 0.922793]

[0.0 0.0 … 0.0 0.0; -3.08768e-5 0.0457502 … 0.194155 0.226134; … ; -0.000121129 0.179885 … 0.783875 0.923536; -0.000139679 0.207582 … 0.910634 1.07585]

[0.0 0.0 … 0.0 0.0; -3.74144e-5 0.0556903 … 0.239797 0.280147; … ; -0.000149871 0.223248 … 0.98194 1.1591; -0.00017359 0.258703 … 1.14468 1.35475]

[0.0 0.0 … 0.0 0.0; -4.25035e-5 0.063609 … 0.278763 0.3269; … ; -0.000174589 0.261066 … 1.1619 1.37485; -0.000203321 0.304092 … 1.36029 1.61356]

[0.0 0.0 … 0.0 0.0; -4.45145e-5 0.0668285 … 0.295937 0.347825; … ; -0.000185571 0.278135 … 1.24683 1.47754; -0.000216813 0.324977 … 1.46351 1.73838]

[0.0 0.0 … 0.0 0.0; 0.195283 0.220105 … 0.289329 0.301009; … ; 0.793124 0.906248 … 1.27318 1.35285; 0.922611 1.05759 … 1.50914 1.61156]

[0.0 0.0 … 0.0 0.0; 0.22609 0.255124 … 0.336388 0.350118; … ; 0.923354 1.05582 … 1.48606 1.57934; 1.07564 1.23385 … 1.76371 1.88373]

[0.0 0.0 … 0.0 0.0; 0.280092 0.316921 … 0.420848 0.438461; … ; 1.15887 1.32737 … 1.87598 1.99443; 1.35449 1.55616 … 2.23295 2.38559]

[0.0 0.0 … 0.0 0.0; 0.326835 0.371059 … 0.49713 0.518575; … ; 1.37458 1.57782 … 2.24124 2.38356; 1.61324 1.85713 … 2.67727 2.861]

[0.0 0.0 … 0.0 0.0; 0.347756 0.395613 … 0.532875 0.556274; … ; 1.47724 1.69786 … 2.41884 2.57275; 1.73804 2.0032 … 2.89553 3.09441]

...

[2.12516 2.44229 … 3.21433 3.2738; 1.68334 1.94118 … 2.59927 2.66269; … ; 0.29143 0.340669 … 0.489607 0.513731; 6.03659e-13 -8.03323e-13 … 5.96151e-13 -1.93997e-12]

[2.34463 2.69138 … 3.55165 3.62713; 1.86277 2.14478 … 2.87306 2.94889; … ; 0.327047 0.381372 … 0.544463 0.570826; 9.64583e-14 -9.0472e-14 … 3.87547e-13 8.1087e-13]

[2.61646 2.9965 … 3.97513 4.08139; 2.09176 2.40098 … 3.21878 3.31651; … ; 0.378133 0.438696 … 0.617731 0.64657; -4.67024e-14 3.80247e-13 … -6.17464e-13 -4.54523e-13]

[2.71611 3.10345 … 4.13664 4.26906; 2.18585 2.50118 … 3.3546 3.46925; … ; 0.407529 0.470247 … 0.652719 0.682019; 9.30935e-13 -7.90052e-13 … 4.40326e-13 -2.97343e-12]

[2.70856 3.09123 … 4.12962 4.27251; 2.18746 2.4991 … 3.35226 3.4731; … ; 0.414537 0.476968 … 0.657116 0.686005; 1.64837e-12 -2.3754e-12 … 3.16698e-12 -4.89262e-13]

[-0.000232162 0.361862 … 1.77994 2.12557; -0.00018196 0.283785 … 1.40569 1.68367; … ; -3.0355e-5 0.0473945 … 0.240565 0.291487; -4.16334e-13 -9.98936e-14 … -6.35319e-13 4.19298e-12]

[-0.000260499 0.404524 … 1.96733 2.34509; -0.000204851 0.318351 … 1.55881 1.86314; … ; -3.46014e-5 0.0538817 … 0.27067 0.327112; 1.249e-13 -4.27094e-14 … 3.68745e-13 1.33434e-12]

[-0.00030088 0.46363 … 2.20339 2.61697; -0.000238325 0.36761 … 1.75786 2.09217; … ; -4.13755e-5 0.064056 … 0.314674 0.378207; -1.249e-13 1.13287e-13 … -1.06955e-13 -6.69401e-13]

[-0.000323501 0.494469 … 2.29557 2.71664; -0.000258325 0.395305 … 1.84477 2.18628; … ; -4.62768e-5 0.0711722 … 0.341137 0.407609; -8.32667e-14 -1.97038e-13 … -3.85498e-13 -1.32133e-12]

[-0.000328428 0.499892 … 2.29332 2.70909; -0.000263435 0.401442 … 1.85009 2.18789; … ; -4.80333e-5 0.0736019 … 0.348091 0.414618; 0.0 -4.48807e-13 … 4.66589e-13 4.70963e-13]

[9.95891e-9 -1.55809e-5 … -6.5452e-5 -7.02117e-5; 7.73245e-9 -1.21088e-5 … -5.2955e-5 -5.83037e-5; … ; 1.24653e-9 -1.95597e-6 … -9.90739e-6 -1.19019e-5; 1.38778e-13 -6.46492e-13 … -1.10174e-12 -2.09356e-12]

[-4.50481e-5 0.0709848 … 0.361326 0.433907; -3.49785e-5 0.0551186 … 0.282588 0.340651; … ; -5.63907e-6 0.00886904 … 0.0463554 0.0565924; 1.66533e-13 -7.18176e-15 … 2.38177e-13 1.69132e-12]

[-0.000126991 0.199577 … 1.00732 1.20798; -9.88238e-5 0.155337 … 0.789693 0.950434; … ; -1.60603e-5 0.0252161 … 0.13088 0.159493; -4.16334e-14 2.00785e-13 … -3.25928e-14 -5.2186e-13]

[-0.000199453 0.311917 … 1.55013 1.8542; -0.000155868 0.243864 … 1.22058 1.46476; … ; -2.57232e-5 0.0402553 … 0.206199 0.250425; -1.66533e-13 -5.71999e-14 … -9.63108e-14 -1.28906e-12]

[-0.000232177 0.361886 … 1.78005 2.1257; -0.000181972 0.283803 … 1.40577 1.68377; … ; -3.0357e-5 0.0473976 … 0.24058 0.291506; 2.22045e-13 -3.42492e-13 … 5.08255e-13 1.56625e-12], ηz = [0.0 1.12359e-9 … 4.76331e-9 5.5895e-9; 0.0 -1.60025e-6 … -6.87765e-6 -8.10344e-6; … ; 0.0 -6.09927e-6 … -3.00948e-5 -3.66688e-5; 0.0 -6.98985e-6 … -3.63974e-5 -4.48637e-5]

[0.0 -5.09114e-6 … -2.15969e-5 -2.53446e-5; 0.0 0.00724223 … 0.030986 0.0364697; … ; 0.0 0.0267764 … 0.11869 0.141287; 0.0 0.0302361 … 0.135354 0.161605]

[0.0 -1.45479e-5 … -6.19863e-5 -7.28087e-5; 0.0 0.0207276 … 0.0890276 0.104869; … ; 0.0 0.0770162 … 0.34218 0.407567; 0.0 0.0870562 … 0.390508 0.466503]

[0.0 -2.34507e-5 … -0.000100785 -0.000118592; 0.0 0.0335159 … 0.145052 0.171137; … ; 0.0 0.125751 … 0.561317 0.669362; 0.0 0.142431 … 0.641541 0.767235]

[0.0 -2.78014e-5 … -0.000120223 -0.000141648; 0.0 0.0398222 … 0.17329 0.204691; … ; 0.0 0.150464 … 0.673914 0.804317; 0.0 0.170672 … 0.771055 0.922859]

[0.0 -2.77995e-5 … -0.000120215 -0.000141638; 0.0 0.0398196 … 0.173278 0.204678; … ; 0.0 0.150454 … 0.673868 0.804261; 0.0 0.170661 … 0.771 0.922793]

[0.0 -3.18567e-5 … -0.000138763 -0.000163742; 0.0 0.0457502 … 0.200374 0.237011; … ; 0.0 0.174302 … 0.783875 0.936508; 0.0 0.198055 … 0.898021 1.07585]

[0.0 -3.85484e-5 … -0.000170709 -0.00020215; 0.0 0.0556903 … 0.247549 0.293752; … ; 0.0 0.216257 … 0.98194 1.17593; 0.0 0.246721 … 1.1283 1.35475]

[0.0 -4.37176e-5 … -0.000197467 -0.000234848; 0.0 0.063609 … 0.28787 0.34295; … ; 0.0 0.252807 … 1.1619 1.39556; 0.0 0.28986 … 1.34011 1.61356]

[0.0 -4.57395e-5 … -0.000208999 -0.000249203; 0.0 0.0668285 … 0.305663 0.36501; … ; 0.0 0.269285 … 1.24683 1.50025; 0.0 0.309677 … 1.44135 1.73838]

[-0.000141638 -0.00016205 … -0.000232259 -0.00024938; 0.204678 0.234846 … 0.341064 0.367643; … ; 0.804261 0.933328 … 1.42534 1.55914; 0.922793 1.07412 … 1.66164 1.82434]

[-0.000163742 -0.000187594 … -0.000269846 -0.0002899; 0.237011 0.272286 … 0.396829 0.428009; … ; 0.936508 1.08789 … 1.66736 1.82545; 1.07585 1.25349 … 1.94629 2.13887]

[-0.00020215 -0.00023233 … -0.000337049 -0.000362573; 0.293752 0.338453 … 0.497306 0.53712; … ; 1.17593 1.36917 … 2.11573 2.32075; 1.35475 1.58198 … 2.47697 2.72771]

[-0.000234848 -0.000270961 … -0.000397284 -0.000428079; 0.34295 0.396557 … 0.588595 0.636787; … ; 1.39556 1.62957 … 2.54291 2.79539; 1.61356 1.8894 … 2.98799 3.29823]

[-0.000249203 -0.000288195 … -0.000425278 -0.000458709; 0.36501 0.422975 … 0.631631 0.684029; … ; 1.50025 1.75483 … 2.75405 3.03111; 1.73838 2.03891 … 3.24312 3.58446]

...

[-2.12557 -2.49835 … -3.75171 -4.01114; -1.71547 -2.02282 … -3.08052 -3.3072; … ; -0.306875 -0.36591 … -0.587611 -0.641461; 0.00019139 0.000228798 … 0.00037242 0.000408371]

[-2.34509 -2.75232 … -4.13469 -4.42823; -1.89793 -2.23385 … -3.39651 -3.65056; … ; -0.344314 -0.409516 … -0.652956 -0.712093; 0.000215623 0.000257119 … 0.000415213 0.000454657]

[-2.61697 -3.06218 … -4.60047 -4.94274; -2.13021 -2.49784 … -3.78364 -4.07484; … ; -0.39792 -0.470771 … -0.739551 -0.804875; 0.000251376 0.00029815 … 0.000473562 0.000517052]

[-2.71664 -3.16892 … -4.75547 -5.12297; -2.22481 -2.59868 … -3.91785 -4.2262; … ; -0.428635 -0.504261 … -0.779893 -0.846937; 0.00027334 0.000322332 … 0.000503099 0.000547661]

[-2.70909 -3.15499 … -4.72934 -5.10056; -2.22574 -2.59456 … -3.90066 -4.21029; … ; -0.435877 -0.511253 … -0.784252 -0.850691; 0.000279364 0.000328417 … 0.000507898 0.000552029]

[0.0 -0.343716 … -1.74695 -2.12557; 0.0 -0.274181 … -1.40569 -1.71547; … ; 0.0 -0.0473945 … -0.248991 -0.306875; 0.0 2.93729e-5 … 0.000154954 0.00019139]

[0.0 -0.384314 … -1.93127 -2.34509; 0.0 -0.307617 … -1.55881 -1.89793; … ; 0.0 -0.0538817 … -0.280115 -0.344314; 0.0 3.35034e-5 … 0.000175029 0.000215623]

[0.0 -0.440662 … -2.16404 -2.61697; 0.0 -0.355317 … -1.75786 -2.13022; … ; 0.0 -0.064056 … -0.325561 -0.39792; 0.0 4.01214e-5 … 0.000205188 0.000251376]

[0.0 -0.470214 … -2.25582 -2.71664; 0.0 -0.382212 … -1.84477 -2.22481; … ; 0.0 -0.0711722 … -0.352823 -0.428635; 0.0 4.49549e-5 … 0.000224475 0.00027334]

[0.0 -0.47551 … -2.25432 -2.70909; 0.0 -0.38822 … -1.85009 -2.22574; … ; 0.0 -0.0736019 … -0.359946 -0.435877; 0.0 4.67114e-5 … 0.000230177 0.000279364]

[0.0 1.41768e-5 … 6.06656e-5 7.02117e-5; 0.0 1.13804e-5 … 5.2955e-5 6.29038e-5; … ; 0.0 1.95597e-6 … 1.05416e-5 1.30807e-5; 0.0 -1.20349e-9 … -6.52181e-9 -8.12201e-9]

[0.0 -0.0673888 … -0.354419 -0.433907; 0.0 -0.0532347 … -0.282588 -0.34729; … ; 0.0 -0.00886904 … -0.0479959 -0.0596124; 0.0 5.44753e-6 … 2.95281e-5 3.67418e-5]

[0.0 -0.189491 … -0.988207 -1.20798; 0.0 -0.15004 … -0.789693 -0.968819; … ; 0.0 -0.0252161 … -0.1355 -0.167982; 0.0 1.55207e-5 … 8.35921e-5 0.00010383]

[0.0 -0.296224 … -1.52111 -1.8542; 0.0 -0.235585 … -1.22058 -1.49271; … ; 0.0 -0.0402553 … -0.213445 -0.263692; 0.0 2.48776e-5 … 0.000132361 0.000163859]

[0.0 -0.343739 … -1.74705 -2.1257; 0.0 -0.274199 … -1.40577 -1.71557; … ; 0.0 -0.0473976 … -0.249007 -0.306895; 0.0 2.93749e-5 … 0.000154965 0.000191402], ζz = [19.9991 19.9998 … 19.9998 19.9992; 19.3418 19.3461 … 19.4268 19.4641; … ; 17.3001 17.3143 … 17.6146 17.7579; 16.8819 16.8978 … 17.2373 17.4]

[19.9991 19.9998 … 19.9998 19.9993; 19.3427 19.3468 … 19.4268 19.464; … ; 17.3035 17.317 … 17.6159 17.7591; 16.8857 16.901 … 17.2391 17.4018]

[19.9991 19.9998 … 19.9998 19.9993; 19.3496 19.352 … 19.427 19.4635; … ; 17.3289 17.3375 … 17.6255 17.7682; 16.9144 16.9245 … 17.2527 17.4155]

[19.9992 19.9998 … 19.9998 19.9993; 19.3632 19.3622 … 19.4276 19.4627; … ; 17.3789 17.3779 … 17.6448 17.7864; 16.9708 16.9711 … 17.28 17.4428]

[19.9993 19.9998 … 19.9998 19.9994; 19.373 19.3698 … 19.4284 19.4624; … ; 17.4152 17.4075 … 17.6593 17.8; 17.0118 17.0051 … 17.3001 17.463]

[19.9993 19.9998 … 19.9998 19.9994; 19.373 19.3698 … 19.4284 19.4624; … ; 17.4152 17.4075 … 17.6593 17.8; 17.0118 17.0051 … 17.3001 17.463]

[19.9993 19.9998 … 19.9998 19.9994; 19.3846 19.3788 … 19.4296 19.4624; … ; 17.4582 17.4428 … 17.6769 17.8166; 17.0604 17.0457 … 17.3243 17.4871]

[19.9995 19.9999 … 19.9999 19.9995; 19.4115 19.4002 … 19.4338 19.4636; … ; 17.5585 17.526 … 17.7199 17.8569; 17.1739 17.1413 … 17.3825 17.5448]

[19.9996 19.9999 … 19.9999 19.9997; 19.4445 19.4273 … 19.4414 19.4677; … ; 17.6828 17.6312 … 17.7775 17.9107; 17.3149 17.2619 … 17.4582 17.6193]

[19.9997 19.9999 … 19.9999 19.9997; 19.4643 19.4441 … 19.4474 19.4716; … ; 17.758 17.6959 … 17.8149 17.9456; 17.4003 17.3361 … 17.5061 17.6662]

[19.9989 20.0 … 20.0 19.9989; 19.462 19.505 … 19.7224 19.7909; … ; 17.7996 17.9723 … 18.888 19.1918; 17.4626 17.6622 … 18.7268 19.0832]

[19.999 20.0 … 20.0 19.999; 19.462 19.504 … 19.7215 19.791; … ; 17.8162 17.9894 … 18.9217 19.2334; 17.4868 17.6881 … 18.7769 19.144]

[19.9991 20.0 … 20.0 19.9992; 19.4633 19.503 … 19.7202 19.7915; … ; 17.8566 18.0306 … 18.9996 19.3291; 17.5445 17.7495 … 18.8925 19.2837]

[19.9994 20.0 … 20.0 19.9994; 19.4675 19.5043 … 19.7199 19.7929; … ; 17.9105 18.0847 … 19.0947 19.4447; 17.6191 17.8278 … 19.033 19.4524]

[19.9995 20.0 … 20.0 19.9996; 19.4714 19.5064 … 19.7204 19.7943; … ; 17.9454 18.1193 … 19.1512 19.5124; 17.6661 17.8764 … 19.116 19.5513]

...

[23.1655 22.8839 … 21.7501 21.4418; 22.5798 22.3441 … 21.3929 21.1351; … ; 20.4957 20.4457 … 20.2404 20.1851; 20.0015 19.9999 … 19.9998 20.0015]

[23.0499 22.7886 … 21.7733 21.501; 22.4776 22.2557 … 21.3936 21.1644; … ; 20.4719 20.4226 … 20.227 20.1758; 20.0014 19.9999 … 19.9998 20.0014]

[22.8061 22.5851 … 21.7984 21.5962; 22.2633 22.0698 … 21.381 21.2072; … ; 20.4219 20.3745 … 20.1997 20.1565; 20.001 19.9999 … 19.9999 20.0011]

[22.542 22.3606 … 21.7873 21.6512; 22.034 21.8695 … 21.3451 21.2235; … ; 20.3686 20.324 … 20.1715 20.1365; 20.0007 20.0 … 19.9999 20.0007]

[22.3984 22.2367 … 21.764 21.659; 21.9107 21.7611 … 21.3155 21.2185; … ; 20.3403 20.2975 … 20.157 20.126; 20.0005 20.0 … 19.9999 20.0005]

[24.2616 24.1673 … 23.4276 23.1646; 23.4858 23.4087 … 22.7979 22.579; … ; 20.6689 20.655 … 20.5386 20.495; 20.0007 20.0002 … 20.0002 20.0008]

[24.1633 24.0511 … 23.2988 23.0492; 23.408 23.3157 … 22.6876 22.4768; … ; 20.6557 20.6389 … 20.5153 20.4712; 20.0007 20.0002 … 20.0002 20.0007]

[23.9393 23.7936 … 23.0275 22.8056; 23.2301 23.109 … 22.4556 22.2628; … ; 20.6253 20.6027 … 20.4657 20.4214; 20.0005 20.0002 … 20.0002 20.0006]

[23.6707 23.4966 … 22.7345 22.5417; 23.016 22.8696 … 22.2065 22.0337; … ; 20.5882 20.56 … 20.4119 20.3682; 20.0004 20.0001 … 20.0001 20.0004]

[23.5129 23.3272 … 22.5757 22.3982; 22.8899 22.7328 … 22.0723 21.9105; … ; 20.5661 20.5352 … 20.383 20.34; 20.0003 20.0001 … 20.0001 20.0003]

[24.5308 24.4974 … 23.8175 23.514; 23.6984 23.6718 … 23.1325 22.8902; … ; 20.7046 20.6996 … 20.608 20.5663; 20.0009 20.0003 … 20.0003 20.0011]

[24.5227 24.4871 … 23.8047 23.5026; 23.692 23.6637 … 23.1216 22.88; … ; 20.7035 20.6982 … 20.6057 20.564; 20.0009 20.0003 … 20.0003 20.001]

[24.4626 24.4119 … 23.7127 23.4202; 23.6446 23.6039 … 23.0426 22.8063; … ; 20.6956 20.6882 … 20.5896 20.5473; 20.0009 20.0003 … 20.0003 20.001]

[24.3455 24.2682 … 23.5427 23.2678; 23.5522 23.4893 … 22.8967 22.6706; … ; 20.6801 20.6688 … 20.5593 20.5161; 20.0008 20.0002 … 20.0002 20.0009]

[24.2616 24.1673 … 23.4275 23.1646; 23.4858 23.4087 … 22.7979 22.579; … ; 20.6689 20.655 … 20.5386 20.495; 20.0007 20.0002 … 20.0002 20.0008], sJ = [0.0025 0.00355505 … 0.00249989 0.00254656; 0.0025 0.00355066 … 0.00258501 0.00261621; … ; 0.0025 0.00331453 … 0.00332832 0.00319982; 0.0025 0.00327273 … 0.00339342 0.00325149]

[0.0025 0.0034093 … 0.00254656 0.0026649; 0.0025 0.00340523 … 0.00261621 0.00269112; … ; 0.0025 0.00296701 … 0.00319982 0.00285612; 0.0025 0.00293389 … 0.00325149 0.00287184]

[0.0025 0.00327286 … 0.0029 0.00274607; 0.0025 0.00322516 … 0.00296748 0.00277276; … ; 0.0025 0.00272006 … 0.00339109 0.00288145; 0.0025 0.00266798 … 0.00343958 0.00291087]

...

[0.00185815 0.0025 … 0.00182025 0.0023145; 0.00188534 0.0025 … 0.00186944 0.00233959; … ; 0.00218396 0.0025 … 0.00185313 0.00226712; 0.00221405 0.0025 … 0.00190177 0.00228709]

[0.00178282 0.0025 … 0.00215356 0.0024607; 0.00178503 0.0025 … 0.00221587 0.00249897; … ; 0.00204902 0.0025 … 0.00209665 0.00244521; 0.00206661 0.0025 … 0.00216255 0.00247282]

[0.00170856 0.0025 … 0.00203846 0.00215356; 0.00171073 0.0025 … 0.0021099 0.00221587; … ; 0.00183477 0.0025 … 0.0019598 0.00209665; 0.00185819 0.0025 … 0.00203846 0.00216255], nx = [-1.0 0.986842 … -0.0 -0.190535; -1.0 0.986983 … -0.0 -0.189496; … ; -1.0 0.992303 … -0.0 -0.125325; -1.0 0.992859 … -0.0 -0.118088]

[-1.0 0.990796 … 0.190535 -0.346344; -1.0 0.990867 … 0.189496 -0.3446; … ; -1.0 0.996133 … 0.125325 -0.242262; -1.0 0.995068 … 0.118088 -0.227137]

[-1.0 0.992855 … 0.135361 -0.271926; -1.0 0.993401 … 0.136616 -0.271721; … ; -1.0 0.987436 … 0.0598398 -0.104257; -1.0 0.985572 … 0.0585693 -0.0992635]

...

[-0.98427 1.0 … 0.138022 -0.240185; -0.984848 1.0 … 0.150053 -0.258345; … ; -0.979864 1.0 … 0.0706164 -0.119227; -0.979224 1.0 … 0.0788633 -0.124703]

[-0.983378 1.0 … 0.155076 -0.286152; -0.983387 1.0 … 0.166074 -0.305137; … ; -0.991484 1.0 … 0.178969 -0.299135; -0.989085 1.0 … 0.181549 -0.301974]

[-0.97281 1.0 … -0.0 -0.155076; -0.973133 1.0 … -0.0 -0.166074; … ; -0.98386 1.0 … -0.0 -0.178969; -0.984265 1.0 … -0.0 -0.181549], ny = [-0.0 -0.161685 … -0.0 -6.45536e-6; -0.0 -0.160826 … -0.0 0.00508559; … ; -0.0 -0.116053 … -0.0 0.0619447; -0.0 -0.107368 … -0.0 0.0713051]

[-0.0 -0.135362 … 6.45536e-6 -4.48146e-6; -0.0 -0.134538 … -0.00508559 0.0035915; … ; -0.0 -0.0412229 … -0.0619447 0.108754; -0.0 -0.0345144 … -0.0713051 0.127291]

[-0.0 -0.107404 … 1.2686e-5 -1.84452e-5; -0.0 -0.0973322 … -0.0149011 0.0246868; … ; -0.0 0.00665254 … -0.0849675 0.166204; -0.0 0.0157944 … -0.0987145 0.19431]

...

[0.152694 -1.09635e-14 … 0.0568556 -0.117645; 0.141983 -1.86656e-14 … 0.0455904 -0.0976741; … ; 0.0646076 -1.20737e-13 … 0.0197806 -0.0376723; 0.0608781 -3.33067e-14 … -8.66986e-6 2.21628e-5]

[0.181571 -6.71685e-14 … -0.0286341 0.0182104; 0.180695 2.71311e-14 … -0.0248429 0.0160074; … ; 0.0673278 -7.77156e-14 … 0.00838542 -0.02008; 0.0683763 -1.18329e-28 … -1.80864e-6 1.0824e-5]

[0.231603 -1.34615e-14 … -0.0 0.0286341; 0.230242 -2.56739e-15 … -0.0 0.0248429; … ; 0.161783 -6.10623e-14 … -0.0 -0.00838542; 0.152715 2.22045e-14 … -0.0 1.80864e-6], nz = [-0.0 2.32825e-10 … -1.0 0.98168; -0.0 -3.56852e-7 … -1.0 0.981868; … ; -0.0 0.0431941 … -1.0 0.99018; -0.0 0.0520017 … -1.0 0.99044]

[-0.0 -5.9689e-6 … -0.98168 0.938108; -0.0 0.0090779 … -0.981868 0.938743; … ; -0.0 0.0775864 … -0.99018 0.964096; -0.0 0.092998 … -0.99044 0.965508]

[-0.0 0.0519857 … -0.990796 0.962318; -0.0 0.0606743 … -0.990512 0.962059; … ; -0.0 0.15788 … -0.994585 0.980565; -0.0 0.168519 … -0.993391 0.975905]

...

[-0.0888602 2.56739e-14 … -0.988796 0.963572; -0.0995761 -3.33067e-14 … -0.987626 0.961102; … ; -0.188926 1.44329e-13 … -0.997307 0.992152; -0.193425 -2.22045e-14 … -0.996885 0.992194]

[1.14144e-5 -2.08167e-14 … -0.987487 0.958011; -0.0173025 -4.85723e-15 … -0.9858 0.952174; … ; -0.111476 2.22045e-14 … -0.983819 0.953999; -0.130523 2.22045e-14 … -0.983382 0.953316]

[-4.84363e-10 6.93889e-15 … -1.0 0.987487; 7.28626e-7 -3.1225e-14 … -1.0 0.9858; … ; -0.0764557 2.22045e-14 … -1.0 0.983819; -0.0888807 6.66134e-14 … -1.0 0.983382])</code></pre></div><h3><a class="nav-anchor" id="Generate-the-State-Vectors-1" href="#Generate-the-State-Vectors-1">Generate the State Vectors</a></h3><p>We need to create as many velocity vectors as there are dimensions.</p><div><pre><code class="language-julia">if dim == 1
  statesyms = (:ρ, :Ux)
elseif dim == 2
  statesyms = (:ρ, :Ux, :Uy)
elseif dim == 3
  statesyms = (:ρ, :Ux, :Uy, :Uz)
end</code></pre><pre><code class="language-none">(:ρ, :Ux, :Uy, :Uz)</code></pre></div><h3><a class="nav-anchor" id="Create-storage-for-state-vector-and-right-hand-side-1" href="#Create-storage-for-state-vector-and-right-hand-side-1">Create storage for state vector and right-hand side</a></h3><p>Q holds the solution vector and rhs the rhs-vector which are dim+1 tuples In addition, here we generate the initial conditions</p><div><pre><code class="language-julia">Q   = NamedTuple{statesyms}(ntuple(j-&gt;zero(coord.x), length(statesyms)))
rhs = NamedTuple{statesyms}(ntuple(j-&gt;zero(coord.x), length(statesyms)))
if dim == 1
  Q.ρ .= sin.(2 * π * x)
  Q.Ux .= 1
elseif dim == 2
  Q.ρ .= sin.(2 * π * x) .* sin.(2 *  π * y)
  Q.Ux .= 1
  Q.Uy .= 1
elseif dim == 3
  Q.ρ .= sin.(2 * π * x) .* sin.(2 *  π * y) .* sin.(2 * π * z)</code></pre></div><p>Q.ρ .= sin.(2 * π * x) .* sin.(2 *  π * y)</p><div><pre><code class="language-julia">  Q.Ux .= 1
  Q.Uy .= 1
  Q.Uz .= 1
end</code></pre><pre><code class="language-none">5×5×5×1000 Array{Float64,4}:
[:, :, 1, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 1, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 1, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

...

[:, :, 1, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 1, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 1, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0</code></pre></div><h3><a class="nav-anchor" id="Compute-the-time-step-size-and-number-of-time-steps-1" href="#Compute-the-time-step-size-and-number-of-time-steps-1">Compute the time-step size and number of time-steps</a></h3><p>Compute a <span>$\Delta t$</span> such that the Courant number is <span>$1$</span>. This is done for each mpirank and then we do an MPI_Allreduce to find the global minimum.</p><div><pre><code class="language-julia">dt = [floatmax(DFloat)]
if dim == 1
    (ξx) = (metric.ξx)
    (Ux) = (Q.Ux)
    for n = 1:length(Ux)
        loc_dt = 2 ./ (abs.(Ux[n] * ξx[n]))
        dt[1] = min(dt[1], loc_dt)
    end
elseif dim == 2
    (ξx, ξy, ηx, ηy) = (metric.ξx, metric.ξy, metric.ηx, metric.ηy)
    (Ux, Uy) = (Q.Ux, Q.Uy)
    for n = 1:length(Ux)
        loc_dt = 2 ./ max(abs.(Ux[n] * ξx[n] + Uy[n] * ξy[n]),
                          abs.(Ux[n] * ηx[n] + Uy[n] * ηy[n]))
        dt[1] = min(dt[1], loc_dt)
    end
elseif dim == 3
    (ξx, ξy, ξz) = (metric.ξx, metric.ξy, metric.ξz)
    (ηx, ηy, ηz) = (metric.ηx, metric.ηy, metric.ηz)
    (ζx, ζy, ζz) = (metric.ζx, metric.ζy, metric.ζz)
    (Ux, Uy, Uz) = (Q.Ux, Q.Uy, Q.Uz)
    for n = 1:length(Ux)
        loc_dt = 2 ./ max(abs.(Ux[n] * ξx[n] + Uy[n] * ξy[n] + Uz[n] * ξz[n]),
                          abs.(Ux[n] * ηx[n] + Uy[n] * ηy[n] + Uz[n] * ηz[n]),
                          abs.(Ux[n] * ζx[n] + Uy[n] * ζy[n] + Uz[n] * ζz[n]))
        dt[1] = min(dt[1], loc_dt)
    end
end
dt = MPI.Allreduce(dt[1], MPI.MIN, mpicomm)
dt = DFloat(dt / N^sqrt(2))
nsteps = ceil(Int64, tend / dt)
dt = tend / nsteps
@show (dt, nsteps)</code></pre><pre><code class="language-none">(dt, nsteps) = (0.005, 2)
(0.005, 2)</code></pre></div><h3><a class="nav-anchor" id="Compute-the-exact-solution-at-the-final-time.-1" href="#Compute-the-exact-solution-at-the-final-time.-1">Compute the exact solution at the final time.</a></h3><p>Later Δ will be used to store the difference between the exact and computed solutions.</p><div><pre><code class="language-julia">Δ   = NamedTuple{statesyms}(ntuple(j-&gt;zero(coord.x), length(statesyms)))
if dim == 1
  Δ.ρ .= sin.(2 * π * (x - tend * Q.Ux))
  Δ.Ux .=  Q.Ux
elseif dim == 2
  Δ.ρ .= sin.(2 * π * (x - tend * Q.Ux)) .* sin.(2 *  π * (y - tend * Q.Uy))
  Δ.Ux .=  Q.Ux
  Δ.Uy .=  Q.Uy
elseif dim == 3
  Δ.ρ .= sin.(2 * π * (x - tend * Q.Ux)) .* sin.(2 *  π * (y - tend * Q.Uy)) .* sin.(2 * π * (z - tend * Q.Uz))</code></pre></div><p>Δ.ρ .= sin.(2 * π * (x - tend * Q.Ux)) .* sin.(2 *  π * (y - tend * Q.Uy))</p><div><pre><code class="language-julia">  Δ.Ux .=  Q.Ux
  Δ.Uy .=  Q.Uy
  Δ.Uz .=  Q.Uz
end</code></pre><pre><code class="language-none">5×5×5×1000 Array{Float64,4}:
[:, :, 1, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 1] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 1, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 2] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 1, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 3] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

...

[:, :, 1, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 998] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 1, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 999] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 1, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 2, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 3, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 4, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0

[:, :, 5, 1000] =
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0
 1.0  1.0  1.0  1.0  1.0</code></pre></div><h3><a class="nav-anchor" id="Store-Explicit-RK-Time-stepping-Coefficients-1" href="#Store-Explicit-RK-Time-stepping-Coefficients-1">Store Explicit RK Time-stepping Coefficients</a></h3><p>We use the fourth-order, low-storage, Runge–Kutta scheme of Carpenter and Kennedy (1994) ((5,4) 2N-Storage RK scheme.</p><p>Ref: @TECHREPORT{CarpenterKennedy1994,   author = {M.~H. Carpenter and C.~A. Kennedy},   title = {Fourth-order {2N-storage} {Runge-Kutta} schemes},   institution = {National Aeronautics and Space Administration},   year = {1994},   number = {NASA TM-109112},   address = {Langley Research Center, Hampton, VA}, }</p><div><pre><code class="language-julia">RKA = (DFloat(0),
       DFloat(-567301805773)  / DFloat(1357537059087),
       DFloat(-2404267990393) / DFloat(2016746695238),
       DFloat(-3550918686646) / DFloat(2091501179385),
       DFloat(-1275806237668) / DFloat(842570457699 ))

RKB = (DFloat(1432997174477) / DFloat(9575080441755 ),
       DFloat(5161836677717) / DFloat(13612068292357),
       DFloat(1720146321549) / DFloat(2090206949498 ),
       DFloat(3134564353537) / DFloat(4481467310338 ),
       DFloat(2277821191437) / DFloat(14882151754819))

RKC = (DFloat(0),
       DFloat(1432997174477) / DFloat(9575080441755),
       DFloat(2526269341429) / DFloat(6820363962896),
       DFloat(2006345519317) / DFloat(3224310063776),
       DFloat(2802321613138) / DFloat(2924317926251))</code></pre></div><h3><a class="nav-anchor" id="Volume-RHS-Routines-1" href="#Volume-RHS-Routines-1">Volume RHS Routines</a></h3><p>These functions solve the volume term <span>$\int_{\Omega_e} \nabla \psi \cdot \left( \rho \mathbf{u} \right)^{(e)}_N$</span> for: Volume RHS for 1D</p><div><pre><code class="language-julia">function volumerhs!(rhs, Q::NamedTuple{S, NTuple{2, T}}, metric, D, ω,
                    elems) where {S, T}
  rhsρ = rhs.ρ
  (ρ, Ux) = (Q.ρ, Q.Ux)
  Nq = size(ρ, 1)
  J = metric.J
  ξx = metric.ξx
  for e ∈ elems</code></pre></div><p>loop of ξ-grid lines</p><div><pre><code class="language-julia">      rhsρ[:,e] += D&#39; * (ω .* J[:,e] .* ρ[:,e] .* (ξx[:,e] .* Ux[:,e]))
  end #e ∈ elems
end #function volumerhs-1d</code></pre><pre><code class="language-none">volumerhs! (generic function with 1 method)</code></pre></div><p>Volume RHS for 2D</p><div><pre><code class="language-julia">function volumerhs!(rhs, Q::NamedTuple{S, NTuple{3, T}}, metric, D, ω,
                    elems) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux, Uy) = (Q.ρ, Q.Ux, Q.Uy)
    Nq = size(ρ, 1)
    J = metric.J
    (ξx, ηx, ξy, ηy) = (metric.ξx, metric.ηx, metric.ξy, metric.ηy)
    for e ∈ elems</code></pre></div><p>loop of ξ-grid lines</p><div><pre><code class="language-julia">        for j = 1:Nq
            rhsρ[:, j, e] +=
                D&#39; * (ω[j] * ω .* J[:, j, e].* ρ[:, j, e] .*
                      (ξx[:, j, e] .* Ux[:, j, e] + ξy[:, j, e] .* Uy[:, j, e]))
        end #j</code></pre></div><p>loop of η-grid lines</p><div><pre><code class="language-julia">        for i = 1:Nq
            rhsρ[i, :, e] +=
                D&#39; * (ω[i] * ω .* J[i, :, e].* ρ[i, :, e] .*
                      (ηx[i, :, e] .* Ux[i, :, e] + ηy[i, :, e] .* Uy[i, :, e]))
        end #i
    end #e ∈ elems
end #function volumerhs-2d</code></pre><pre><code class="language-none">volumerhs! (generic function with 2 methods)</code></pre></div><p>Volume RHS for 3D</p><div><pre><code class="language-julia">function volumerhs!(rhs, Q::NamedTuple{S, NTuple{4, T}}, metric, D, ω,
                    elems) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux, Uy, Uz) = (Q.ρ, Q.Ux, Q.Uy, Q.Uz)
    Nq = size(ρ, 1)
    J = metric.J
    (ξx, ηx, ζx) = (metric.ξx, metric.ηx, metric.ζx)
    (ξy, ηy, ζy) = (metric.ξy, metric.ηy, metric.ζy)
    (ξz, ηz, ζz) = (metric.ξz, metric.ηz, metric.ζz)
    for e ∈ elems</code></pre></div><p>loop of ξ-grid lines</p><div><pre><code class="language-julia">        for k = 1:Nq
            for j = 1:Nq
                rhsρ[:, j, k, e] +=
                    D&#39; * (ω[j] * ω[k] * ω .* J[:, j, k, e] .* ρ[:, j, k, e] .*
                          (ξx[:, j, k, e] .* Ux[:, j, k, e] +
                           ξy[:, j, k, e] .* Uy[:, j, k, e] +
                           ξz[:, j, k, e] .* Uz[:, j, k, e]))
            end #j
        end #k</code></pre></div><p>loop of η-grid lines</p><div><pre><code class="language-julia">        for k = 1:Nq
            for i = 1:Nq
                rhsρ[i, :, k, e] +=
                    D&#39; * (ω[i] * ω[k] * ω .* J[i, :, k, e] .* ρ[i, :, k, e] .*
                          (ηx[i, :, k, e] .* Ux[i, :, k, e] +
                           ηy[i, :, k, e] .* Uy[i, :, k, e] +
                           ηz[i, :, k, e] .* Uz[i, :, k, e]))
            end #i
        end #k</code></pre></div><p>loop of ζ-grid lines</p><div><pre><code class="language-julia">        for j = 1:Nq
            for i = 1:Nq
                rhsρ[i, j, :, e] +=
                    D&#39; * (ω[i] * ω[j] * ω .* J[i, j, :, e] .* ρ[i, j, :, e] .*
                          (ζx[i, j, :, e] .* Ux[i, j, :, e] +
                           ζy[i, j, :, e] .* Uy[i, j, :, e] +
                           ζz[i, j, :, e] .* Uz[i, j, :, e]))
            end #i
        end #j
    end #e ∈ elems
end</code></pre><pre><code class="language-none">volumerhs! (generic function with 3 methods)</code></pre></div><h3><a class="nav-anchor" id="Flux-RHS-Routines-1" href="#Flux-RHS-Routines-1">Flux RHS Routines</a></h3><p>These functions solve the flux integral term <span>$\int_{\Gamma_e} \psi \mathbf{n} \cdot \left( \rho \mathbf{u} \right)^{(*,e)}_N$</span> for: Flux RHS for 1D</p><div><pre><code class="language-julia">function fluxrhs!(rhs, Q::NamedTuple{S, NTuple{2, T}}, metric, ω, elems, vmapM,
                  vmapP) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux) = (Q.ρ, Q.Ux)
    nface = 2
    (nx, sJ) = (metric.nx, metric.sJ)
    nx = reshape(nx, size(vmapM))
    sJ = reshape(sJ, size(vmapM))

    for e ∈ elems
        for f ∈ 1:nface
            ρM = ρ[vmapM[1, f, e]]
            UxM = Ux[vmapM[1, f, e]]
            FxM = ρM .* UxM

            ρP = ρ[vmapP[1, f, e]]
            UxP = Ux[vmapP[1, f, e]]
            FxP = ρP .* UxP

            nxM = nx[1, f, e]
            λ = max.(abs.(nxM .* UxM), abs.(nxM .* UxP))

            F = (nxM .* (FxM + FxP) - λ .* (ρP - ρM)) / 2
            rhsρ[vmapM[1, f, e]] -= sJ[1, f, e] .* F
        end #for f ∈ 1:nface
    end #e ∈ elems
end #function fluxrhs-1d</code></pre><pre><code class="language-none">fluxrhs! (generic function with 1 method)</code></pre></div><p>Flux RHS for 2D</p><div><pre><code class="language-julia">function fluxrhs!(rhs, Q::NamedTuple{S, NTuple{3, T}}, metric, ω, elems, vmapM,
                  vmapP) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux, Uy) = (Q.ρ, Q.Ux, Q.Uy)
    nface = 4
    (nx, ny, sJ) = (metric.nx, metric.ny, metric.sJ)
    for e ∈ elems
        for f ∈ 1:nface
            ρM = ρ[vmapM[:, f, e]]
            UxM = Ux[vmapM[:, f, e]]
            UyM = Uy[vmapM[:, f, e]]
            FxM = ρM .* UxM
            FyM = ρM .* UyM

            ρP = ρ[vmapP[:, f, e]]
            UxP = Ux[vmapP[:, f, e]]
            UyP = Uy[vmapP[:, f, e]]
            FxP = ρP .* UxP
            FyP = ρP .* UyP

            nxM = nx[:, f, e]
            nyM = ny[:, f, e]
            λ = max.(abs.(nxM .* UxM + nyM .* UyM), abs.(nxM .* UxP + nyM .* UyP))

            F = (nxM .* (FxM + FxP) + nyM .* (FyM + FyP) + λ .* (ρM - ρP)) / 2
            rhsρ[vmapM[:, f, e]] -= ω .* sJ[:, f, e] .* F
        end #f ∈ 1:nface
    end #e ∈ elems
end #function fluxrhs-2d</code></pre><pre><code class="language-none">fluxrhs! (generic function with 2 methods)</code></pre></div><p>FLux RHS for 3D</p><div><pre><code class="language-julia">function fluxrhs!(rhs, Q::NamedTuple{S, NTuple{4, T}}, metric, ω, elems, vmapM,
                  vmapP) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux, Uy, Uz) = (Q.ρ, Q.Ux, Q.Uy, Q.Uz)
    nface = 6
    (nx, ny, nz, sJ) = (metric.nx, metric.ny, metric.nz, metric.sJ)
    nx = reshape(nx, size(vmapM))
    ny = reshape(ny, size(vmapM))
    nz = reshape(nz, size(vmapM))
    sJ = reshape(sJ, size(vmapM))
    for e ∈ elems
        for f ∈ 1:nface
            ρM = ρ[vmapM[:, f, e]]
            UxM = Ux[vmapM[:, f, e]]
            UyM = Uy[vmapM[:, f, e]]
            UzM = Uz[vmapM[:, f, e]]
            FxM = ρM .* UxM
            FyM = ρM .* UyM
            FzM = ρM .* UzM

            ρP = ρ[vmapP[:, f, e]]
            UxP = Ux[vmapP[:, f, e]]
            UyP = Uy[vmapP[:, f, e]]
            UzP = Uz[vmapP[:, f, e]]
            FxP = ρP .* UxP
            FyP = ρP .* UyP
            FzP = ρP .* UzP

            nxM = nx[:, f, e]
            nyM = ny[:, f, e]
            nzM = nz[:, f, e]
            λ = max.(abs.(nxM .* UxM + nyM .* UyM + nzM .* UzM),
                     abs.(nxM .* UxP + nyM .* UyP + nzM .* UzP))

            F = (nxM .* (FxM + FxP) + nyM .* (FyM + FyP) + nzM .* (FzM + FzP) +
                 λ .* (ρM - ρP)) / 2
            rhsρ[vmapM[:, f, e]] -= kron(ω, ω) .* sJ[:, f, e] .* F
        end #f ∈ 1:nface
    end #e ∈ elems
end #function fluxrhs-3d</code></pre><pre><code class="language-none">fluxrhs! (generic function with 3 methods)</code></pre></div><h3><a class="nav-anchor" id="Update-the-solution-via-RK-Method-for:-1" href="#Update-the-solution-via-RK-Method-for:-1">Update the solution via RK Method for:</a></h3><p>Update 1D</p><div><pre><code class="language-julia">function updatesolution!(rhs, Q::NamedTuple{S, NTuple{2, T}}, metric, ω, elems,
                         rka, rkb, dt) where {S, T}
    J = metric.J
    M =  ω
    for (rhsq, q) ∈ zip(rhs, Q)
        for e ∈ elems
            q[:, e] += rkb * dt * rhsq[:, e] ./ ( M .* J[:, e])
            rhsq[:, e] *= rka
        end
    end
end</code></pre><pre><code class="language-none">updatesolution! (generic function with 1 method)</code></pre></div><p>Update 2D</p><div><pre><code class="language-julia">function updatesolution!(rhs, Q::NamedTuple{S, NTuple{3, T}}, metric, ω, elems,
                         rka, rkb, dt) where {S, T}
    J = metric.J
    M = reshape(kron(ω, ω), length(ω), length(ω))
    for (rhsq, q) ∈ zip(rhs, Q)
        for e ∈ elems
            q[:, :, e] += rkb * dt * rhsq[:, :, e] ./ (M .* J[:, :, e])
            rhsq[:, :, e] *= rka
        end
    end
end</code></pre><pre><code class="language-none">updatesolution! (generic function with 2 methods)</code></pre></div><p>Update 3D</p><div><pre><code class="language-julia">function updatesolution!(rhs, Q::NamedTuple{S, NTuple{4, T}}, metric, ω, elems,
                         rka, rkb, dt) where {S, T}
    J = metric.J
    M = reshape(kron(ω, ω, ω), length(ω), length(ω), length(ω))
    for (rhsq, q) ∈ zip(rhs, Q)
        for e ∈ elems
            q[:, :, :, e] += rkb * dt * rhsq[:, :, :, e] ./ (M .* J[:, :, :, e])
            rhsq[:, :, :, e] *= rka
        end
    end
end</code></pre><pre><code class="language-none">updatesolution! (generic function with 3 methods)</code></pre></div><h3><a class="nav-anchor" id="Compute-L2-Error-Norm-for:-1" href="#Compute-L2-Error-Norm-for:-1">Compute L2 Error Norm for:</a></h3><p>1D Error</p><div><pre><code class="language-julia">function L2energy(Q::NamedTuple{S, NTuple{2, T}}, metric, ω, elems) where {S, T}
  J = metric.J
  Nq = length(ω)
  M = ω
  index = CartesianIndices(ntuple(j-&gt;1:Nq, Val(1)))

  energy = [zero(J[1])]
  for q ∈ Q
    for e ∈ elems
      for ind ∈ index
        energy[1] += M[ind] * J[ind, e] * q[ind, e]^2
      end
    end
  end
  energy[1]
end</code></pre><pre><code class="language-none">L2energy (generic function with 1 method)</code></pre></div><p>2D Error</p><div><pre><code class="language-julia">function L2energy(Q::NamedTuple{S, NTuple{3, T}}, metric, ω, elems) where {S, T}
  J = metric.J
  Nq = length(ω)
  M = reshape(kron(ω, ω), Nq, Nq)
  index = CartesianIndices(ntuple(j-&gt;1:Nq, Val(2)))

  energy = [zero(J[1])]
  for q ∈ Q
    for e ∈ elems
      for ind ∈ index
        energy[1] += M[ind] * J[ind, e] * q[ind, e]^2
      end
    end
  end
  energy[1]
end</code></pre><pre><code class="language-none">L2energy (generic function with 2 methods)</code></pre></div><p>3D Error</p><div><pre><code class="language-julia">function L2energy(Q::NamedTuple{S, NTuple{4, T}}, metric, ω, elems) where {S, T}
  J = metric.J
  Nq = length(ω)
  M = reshape(kron(ω, ω, ω), Nq, Nq, Nq)
  index = CartesianIndices(ntuple(j-&gt;1:Nq, Val(3)))

  energy = [zero(J[1])]
  for q ∈ Q
    for e ∈ elems
      for ind ∈ index
        energy[1] += M[ind] * J[ind, e] * q[ind, e]^2
      end
    end
  end
  energy[1]
end</code></pre><pre><code class="language-none">L2energy (generic function with 3 methods)</code></pre></div><h3><a class="nav-anchor" id="Compute-how-many-MPI-neighbors-we-have-1" href="#Compute-how-many-MPI-neighbors-we-have-1">Compute how many MPI neighbors we have</a></h3><p>&quot;mesh.nabrtorank&quot; stands for &quot;Neighbors to rank&quot;</p><div><pre><code class="language-julia">numnabr = length(mesh.nabrtorank)</code></pre><pre><code class="language-none">0</code></pre></div><h3><a class="nav-anchor" id="Create-send/recv-request-arrays-1" href="#Create-send/recv-request-arrays-1">Create send/recv request arrays</a></h3><p>&quot;sendreq&quot; is the array that we use to send the communication request. It needs to be of the same length as the number of neighboring ranks. Similarly, &quot;recvreq&quot; is the array that we use to receive the neighboring rank information.</p><div><pre><code class="language-julia">sendreq = fill(MPI.REQUEST_NULL, numnabr)
recvreq = fill(MPI.REQUEST_NULL, numnabr)</code></pre><pre><code class="language-none">0-element Array{MPI.Request,1}</code></pre></div><h3><a class="nav-anchor" id="Create-send/recv-buffer-1" href="#Create-send/recv-buffer-1">Create send/recv buffer</a></h3><p>The dimensions of these arrays are (1) degrees of freedom within an element, (2) number of solution vectors, and (3) the number of &quot;send elements&quot; and &quot;ghost elements&quot;, respectively.</p><div><pre><code class="language-julia">sendQ = Array{DFloat, 3}(undef, (N+1)^dim, length(Q), length(mesh.sendelems))
recvQ = Array{DFloat, 3}(undef, (N+1)^dim, length(Q), length(mesh.ghostelems))</code></pre><pre><code class="language-none">125×4×0 Array{Float64,3}</code></pre></div><p>Build CartesianIndex map for moving between Cartesian and linear storage of dofs</p><div><pre><code class="language-julia">index = CartesianIndices(ntuple(j-&gt;1:N+1, dim))
nrealelem = length(mesh.realelems)</code></pre><pre><code class="language-none">1000</code></pre></div><h3><a class="nav-anchor" id="Dump-the-initial-condition-1" href="#Dump-the-initial-condition-1">Dump the initial condition</a></h3><p>Dump out the initial conditin to VTK prior to entering the time-step loop.</p><div><pre><code class="language-julia">include(joinpath(@__DIR__, &quot;vtk.jl&quot;))
writemesh(@sprintf(&quot;Advection%dD_rank_%04d_step_%05d&quot;, dim, mpirank, 0),
          coord...; fields=((&quot;ρ&quot;, Q.ρ),), realelems=mesh.realelems)</code></pre></div><h3><a class="nav-anchor" id="Begin-Time-step-loop-1" href="#Begin-Time-step-loop-1">Begin Time-step loop</a></h3><p>Go through nsteps time-steps and for each time-step, loop through the s-stages of the explicit RK method.</p><div><pre><code class="language-julia">for step = 1:nsteps
    mpirank == 0 &amp;&amp; @show step
    for s = 1:length(RKA)</code></pre></div><h4><a class="nav-anchor" id="Post-MPI-receives-1" href="#Post-MPI-receives-1">Post MPI receives</a></h4><p>We assume that an MPI_Isend has been posted (non-blocking send) and are waiting to receive any message that has been posted for receiving.  We are looping through the : (1) number of neighbors, (2) neighbor ranks, and (3) neighbor elements.</p><div><pre><code class="language-julia">        for (nnabr, nabrrank, nabrelem) ∈ zip(1:numnabr, mesh.nabrtorank,
                                              mesh.nabrtorecv)
            recvreq[nnabr] = MPI.Irecv!((@view recvQ[:, :, nabrelem]), nabrrank, 777,
                                        mpicomm)
        end</code></pre></div><h4><a class="nav-anchor" id="Wait-on-(prior)-MPI-sends-1" href="#Wait-on-(prior)-MPI-sends-1">Wait on (prior) MPI sends</a></h4><p>WE assume that non-blocking sends have been sent and wait for this to happen. FXG: Why do we need to wait?</p><div><pre><code class="language-julia">        MPI.Waitall!(sendreq)</code></pre></div><h4><a class="nav-anchor" id="Pack-data-to-send-buffer-1" href="#Pack-data-to-send-buffer-1">Pack data to send buffer</a></h4><p>For all faces &quot;nf&quot; and all elements &quot;ne&quot; we pack the send data.</p><div><pre><code class="language-julia">        for (ne, e) ∈ enumerate(mesh.sendelems)
            for (nf, f) ∈ enumerate(Q)
                sendQ[:, nf, ne] = f[index[:], e]
            end
        end</code></pre></div><h4><a class="nav-anchor" id="Post-MPI-sends-1" href="#Post-MPI-sends-1">Post MPI sends</a></h4><p>For all: (1) number of neighbors, (2) neighbor ranks, and (3) neighbor elements we perform a non-blocking send.</p><div><pre><code class="language-julia">        for (nnabr, nabrrank, nabrelem) ∈ zip(1:numnabr, mesh.nabrtorank,
                                              mesh.nabrtosend)
            sendreq[nnabr] = MPI.Isend((@view sendQ[:, :, nabrelem]), nabrrank, 777,
                                       mpicomm)
        end</code></pre></div><h4><a class="nav-anchor" id="Compute-RHS-Volume-Integral-1" href="#Compute-RHS-Volume-Integral-1">Compute RHS Volume Integral</a></h4><p>Note that it is not necessary to have received all the MPI messages. Here we are interleaving computation with communication in order to curtail latency.  Here we perform the RHS volume integrals.</p><div><pre><code class="language-julia">        volumerhs!(rhs, Q, metric, D, ω, mesh.realelems)</code></pre></div><h4><a class="nav-anchor" id="Wait-on-MPI-receives-1" href="#Wait-on-MPI-receives-1">Wait on MPI receives</a></h4><p>We need to wait to receive the messages before we move on to the flux integrals.</p><div><pre><code class="language-julia">        MPI.Waitall!(recvreq)</code></pre></div><h4><a class="nav-anchor" id="Unpack-data-from-receive-buffer-1" href="#Unpack-data-from-receive-buffer-1">Unpack data from receive buffer</a></h4><p>The inverse of the Pack datat to send buffer. We now unpack the receive buffer in order to use it in the RHS flux integral.</p><div><pre><code class="language-julia">        for elems ∈ mesh.nabrtorecv
            for (nf, f) ∈ enumerate(Q)
                f[index[:], nrealelem .+ elems] = recvQ[:, nf, elems]
            end
        end</code></pre></div><h4><a class="nav-anchor" id="Compute-RHS-Flux-Integral-1" href="#Compute-RHS-Flux-Integral-1">Compute RHS Flux Integral</a></h4><p>We compute the flux integral on all &quot;realelems&quot; which are the elements owned by the current mpirank.</p><div><pre><code class="language-julia">        fluxrhs!(rhs, Q, metric, ω, mesh.realelems, vmapM, vmapP)</code></pre></div><h4><a class="nav-anchor" id="Update-solution-and-scale-RHS-1" href="#Update-solution-and-scale-RHS-1">Update solution and scale RHS</a></h4><p>We need to update/evolve the solution in time and multiply by the inverse mass matrix.</p><div><pre><code class="language-julia">        updatesolution!(rhs, Q, metric, ω, mesh.realelems, RKA[s%length(RKA)+1],
                        RKB[s], dt)
    end</code></pre></div><h4><a class="nav-anchor" id="Write-VTK-Output-1" href="#Write-VTK-Output-1">Write VTK Output</a></h4><p>After each time-step, we dump out VTK data for Paraview/VisIt.</p><div><pre><code class="language-julia">    writemesh(@sprintf(&quot;Advection%dD_rank_%04d_step_%05d&quot;, dim, mpirank, step),
              coord...; fields=((&quot;ρ&quot;, Q.ρ),), realelems=mesh.realelems)
end</code></pre><pre><code class="language-none">step = 1
step = 2</code></pre></div><h3><a class="nav-anchor" id="Compute-L2-Error-Norms-1" href="#Compute-L2-Error-Norms-1">Compute L2 Error Norms</a></h3><p>Since we stored the initial condition, we can now compute the L2 error norms for both the solution and energy.</p><div><pre><code class="language-julia">for (δ, q) ∈ zip(Δ, Q)
    δ .-= q
end
eng = L2energy(Q, metric, ω, mesh.realelems)
eng = MPI.Allreduce(eng, MPI.SUM, mpicomm)
mpirank == 0 &amp;&amp; @show sqrt(eng)

err = L2energy(Δ, metric, ω, mesh.realelems)
err = MPI.Allreduce(err, MPI.SUM, mpicomm)
mpirank == 0 &amp;&amp; @show sqrt(err)

nothing</code></pre><pre><code class="language-none">sqrt(eng) = 1.7677669528573736
sqrt(err) = 2.565534459000735e-5</code></pre></div><h2><a class="nav-anchor" id="advection-plain-program-1" href="#advection-plain-program-1">Plain Program</a></h2><p>Below follows a version of the program without any comments. The file is also available here: <a href="../advection.jl">advection.jl</a></p><pre><code class="language-julia">N = 4 #polynomial order
#brickN = (10) #1D brickmesh
#brickN = (10, 10) #2D brickmesh
brickN = (10, 10, 10) #3D brickmesh
DFloat = Float64 #Number Type
tend = DFloat(0.01) #Final Time

using MPI
using Canary
using Printf: @sprintf

dim = length(brickN)

println(&quot;N= &quot;,N)
println(&quot;dim= &quot;,dim)
println(&quot;brickN= &quot;,brickN)
println(&quot;DFloat= &quot;,DFloat)

MPI.Initialized() || MPI.Init() # only initialize MPI if not initialized
MPI.finalize_atexit()
mpicomm = MPI.COMM_WORLD
mpirank = MPI.Comm_rank(mpicomm)
mpisize = MPI.Comm_size(mpicomm)

if dim == 1
  (Nx, ) = brickN
  local x = range(DFloat(0); length=Nx+1, stop=1)
  mesh = brickmesh((x, ), (true, ); part=mpirank+1, numparts=mpisize)
elseif dim == 2
  (Nx, Ny) = brickN
  local x = range(DFloat(0); length=Nx+1, stop=1)
  local y = range(DFloat(0); length=Ny+1, stop=1)
  mesh = brickmesh((x, y), (true, true); part=mpirank+1, numparts=mpisize)
else
  (Nx, Ny, Nz) = brickN
  local x = range(DFloat(0); length=Nx+1, stop=1)
  local y = range(DFloat(0); length=Ny+1, stop=1)
  local z = range(DFloat(0); length=Nz+1, stop=1)
  mesh = brickmesh((x, y, z), (true, true, true);
                   part=mpirank+1, numparts=mpisize)
end

mesh = partition(mpicomm, mesh...)

mesh = connectmesh(mpicomm, mesh...)

(vmapM, vmapP) = mappings(N, mesh.elemtoelem, mesh.elemtoface, mesh.elemtoordr)

(ξ, ω) = lglpoints(DFloat, N)
D = spectralderivative(ξ)

(nface, nelem) = size(mesh.elemtoelem)
coord = creategrid(Val(dim), mesh.elemtocoord, ξ)
if dim == 1
  x = coord.x
  for j = 1:length(x)
    x[j] = x[j]
  end
elseif dim == 2
  (x, y) = (coord.x, coord.y)
  for j = 1:length(x)
    (x[j], y[j]) = (x[j] .+ sin.(π * x[j]) .* sin.(2 * π * y[j]) / 10,
                    y[j] .+ sin.(2 * π * x[j]) .* sin.(π * y[j]) / 10)
  end
elseif dim == 3
  (x, y, z) = (coord.x, coord.y, coord.z)
  for j = 1:length(x)
    (x[j], y[j], z[j]) = (x[j] + (sin(π * x[j]) * sin(2 * π * y[j]) *
                                  cos(2 * π * z[j])) / 10,
                          y[j] + (sin(π * y[j]) * sin(2 * π * x[j]) *
                                  cos(2 * π * z[j])) / 10,
                          z[j] + (sin(π * z[j]) * sin(2 * π * x[j]) *
                                  cos(2 * π * y[j])) / 10)
  end
end

include(joinpath(@__DIR__, &quot;vtk.jl&quot;))
writemesh(@sprintf(&quot;Advection%dD_rank_%04d_mesh&quot;, dim, mpirank), coord...;
          realelems=mesh.realelems)

metric = computemetric(coord..., D)

if dim == 1
  statesyms = (:ρ, :Ux)
elseif dim == 2
  statesyms = (:ρ, :Ux, :Uy)
elseif dim == 3
  statesyms = (:ρ, :Ux, :Uy, :Uz)
end

Q   = NamedTuple{statesyms}(ntuple(j-&gt;zero(coord.x), length(statesyms)))
rhs = NamedTuple{statesyms}(ntuple(j-&gt;zero(coord.x), length(statesyms)))
if dim == 1
  Q.ρ .= sin.(2 * π * x)
  Q.Ux .= 1
elseif dim == 2
  Q.ρ .= sin.(2 * π * x) .* sin.(2 *  π * y)
  Q.Ux .= 1
  Q.Uy .= 1
elseif dim == 3
  Q.ρ .= sin.(2 * π * x) .* sin.(2 *  π * y) .* sin.(2 * π * z)

  Q.Ux .= 1
  Q.Uy .= 1
  Q.Uz .= 1
end

dt = [floatmax(DFloat)]
if dim == 1
    (ξx) = (metric.ξx)
    (Ux) = (Q.Ux)
    for n = 1:length(Ux)
        loc_dt = 2 ./ (abs.(Ux[n] * ξx[n]))
        dt[1] = min(dt[1], loc_dt)
    end
elseif dim == 2
    (ξx, ξy, ηx, ηy) = (metric.ξx, metric.ξy, metric.ηx, metric.ηy)
    (Ux, Uy) = (Q.Ux, Q.Uy)
    for n = 1:length(Ux)
        loc_dt = 2 ./ max(abs.(Ux[n] * ξx[n] + Uy[n] * ξy[n]),
                          abs.(Ux[n] * ηx[n] + Uy[n] * ηy[n]))
        dt[1] = min(dt[1], loc_dt)
    end
elseif dim == 3
    (ξx, ξy, ξz) = (metric.ξx, metric.ξy, metric.ξz)
    (ηx, ηy, ηz) = (metric.ηx, metric.ηy, metric.ηz)
    (ζx, ζy, ζz) = (metric.ζx, metric.ζy, metric.ζz)
    (Ux, Uy, Uz) = (Q.Ux, Q.Uy, Q.Uz)
    for n = 1:length(Ux)
        loc_dt = 2 ./ max(abs.(Ux[n] * ξx[n] + Uy[n] * ξy[n] + Uz[n] * ξz[n]),
                          abs.(Ux[n] * ηx[n] + Uy[n] * ηy[n] + Uz[n] * ηz[n]),
                          abs.(Ux[n] * ζx[n] + Uy[n] * ζy[n] + Uz[n] * ζz[n]))
        dt[1] = min(dt[1], loc_dt)
    end
end
dt = MPI.Allreduce(dt[1], MPI.MIN, mpicomm)
dt = DFloat(dt / N^sqrt(2))
nsteps = ceil(Int64, tend / dt)
dt = tend / nsteps
@show (dt, nsteps)

Δ   = NamedTuple{statesyms}(ntuple(j-&gt;zero(coord.x), length(statesyms)))
if dim == 1
  Δ.ρ .= sin.(2 * π * (x - tend * Q.Ux))
  Δ.Ux .=  Q.Ux
elseif dim == 2
  Δ.ρ .= sin.(2 * π * (x - tend * Q.Ux)) .* sin.(2 *  π * (y - tend * Q.Uy))
  Δ.Ux .=  Q.Ux
  Δ.Uy .=  Q.Uy
elseif dim == 3
  Δ.ρ .= sin.(2 * π * (x - tend * Q.Ux)) .* sin.(2 *  π * (y - tend * Q.Uy)) .* sin.(2 * π * (z - tend * Q.Uz))

  Δ.Ux .=  Q.Ux
  Δ.Uy .=  Q.Uy
  Δ.Uz .=  Q.Uz
end

RKA = (DFloat(0),
       DFloat(-567301805773)  / DFloat(1357537059087),
       DFloat(-2404267990393) / DFloat(2016746695238),
       DFloat(-3550918686646) / DFloat(2091501179385),
       DFloat(-1275806237668) / DFloat(842570457699 ))

RKB = (DFloat(1432997174477) / DFloat(9575080441755 ),
       DFloat(5161836677717) / DFloat(13612068292357),
       DFloat(1720146321549) / DFloat(2090206949498 ),
       DFloat(3134564353537) / DFloat(4481467310338 ),
       DFloat(2277821191437) / DFloat(14882151754819))

RKC = (DFloat(0),
       DFloat(1432997174477) / DFloat(9575080441755),
       DFloat(2526269341429) / DFloat(6820363962896),
       DFloat(2006345519317) / DFloat(3224310063776),
       DFloat(2802321613138) / DFloat(2924317926251))

function volumerhs!(rhs, Q::NamedTuple{S, NTuple{2, T}}, metric, D, ω,
                    elems) where {S, T}
  rhsρ = rhs.ρ
  (ρ, Ux) = (Q.ρ, Q.Ux)
  Nq = size(ρ, 1)
  J = metric.J
  ξx = metric.ξx
  for e ∈ elems

      rhsρ[:,e] += D&#39; * (ω .* J[:,e] .* ρ[:,e] .* (ξx[:,e] .* Ux[:,e]))
  end #e ∈ elems
end #function volumerhs-1d

function volumerhs!(rhs, Q::NamedTuple{S, NTuple{3, T}}, metric, D, ω,
                    elems) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux, Uy) = (Q.ρ, Q.Ux, Q.Uy)
    Nq = size(ρ, 1)
    J = metric.J
    (ξx, ηx, ξy, ηy) = (metric.ξx, metric.ηx, metric.ξy, metric.ηy)
    for e ∈ elems

        for j = 1:Nq
            rhsρ[:, j, e] +=
                D&#39; * (ω[j] * ω .* J[:, j, e].* ρ[:, j, e] .*
                      (ξx[:, j, e] .* Ux[:, j, e] + ξy[:, j, e] .* Uy[:, j, e]))
        end #j

        for i = 1:Nq
            rhsρ[i, :, e] +=
                D&#39; * (ω[i] * ω .* J[i, :, e].* ρ[i, :, e] .*
                      (ηx[i, :, e] .* Ux[i, :, e] + ηy[i, :, e] .* Uy[i, :, e]))
        end #i
    end #e ∈ elems
end #function volumerhs-2d

function volumerhs!(rhs, Q::NamedTuple{S, NTuple{4, T}}, metric, D, ω,
                    elems) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux, Uy, Uz) = (Q.ρ, Q.Ux, Q.Uy, Q.Uz)
    Nq = size(ρ, 1)
    J = metric.J
    (ξx, ηx, ζx) = (metric.ξx, metric.ηx, metric.ζx)
    (ξy, ηy, ζy) = (metric.ξy, metric.ηy, metric.ζy)
    (ξz, ηz, ζz) = (metric.ξz, metric.ηz, metric.ζz)
    for e ∈ elems

        for k = 1:Nq
            for j = 1:Nq
                rhsρ[:, j, k, e] +=
                    D&#39; * (ω[j] * ω[k] * ω .* J[:, j, k, e] .* ρ[:, j, k, e] .*
                          (ξx[:, j, k, e] .* Ux[:, j, k, e] +
                           ξy[:, j, k, e] .* Uy[:, j, k, e] +
                           ξz[:, j, k, e] .* Uz[:, j, k, e]))
            end #j
        end #k

        for k = 1:Nq
            for i = 1:Nq
                rhsρ[i, :, k, e] +=
                    D&#39; * (ω[i] * ω[k] * ω .* J[i, :, k, e] .* ρ[i, :, k, e] .*
                          (ηx[i, :, k, e] .* Ux[i, :, k, e] +
                           ηy[i, :, k, e] .* Uy[i, :, k, e] +
                           ηz[i, :, k, e] .* Uz[i, :, k, e]))
            end #i
        end #k

        for j = 1:Nq
            for i = 1:Nq
                rhsρ[i, j, :, e] +=
                    D&#39; * (ω[i] * ω[j] * ω .* J[i, j, :, e] .* ρ[i, j, :, e] .*
                          (ζx[i, j, :, e] .* Ux[i, j, :, e] +
                           ζy[i, j, :, e] .* Uy[i, j, :, e] +
                           ζz[i, j, :, e] .* Uz[i, j, :, e]))
            end #i
        end #j
    end #e ∈ elems
end

function fluxrhs!(rhs, Q::NamedTuple{S, NTuple{2, T}}, metric, ω, elems, vmapM,
                  vmapP) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux) = (Q.ρ, Q.Ux)
    nface = 2
    (nx, sJ) = (metric.nx, metric.sJ)
    nx = reshape(nx, size(vmapM))
    sJ = reshape(sJ, size(vmapM))

    for e ∈ elems
        for f ∈ 1:nface
            ρM = ρ[vmapM[1, f, e]]
            UxM = Ux[vmapM[1, f, e]]
            FxM = ρM .* UxM

            ρP = ρ[vmapP[1, f, e]]
            UxP = Ux[vmapP[1, f, e]]
            FxP = ρP .* UxP

            nxM = nx[1, f, e]
            λ = max.(abs.(nxM .* UxM), abs.(nxM .* UxP))

            F = (nxM .* (FxM + FxP) - λ .* (ρP - ρM)) / 2
            rhsρ[vmapM[1, f, e]] -= sJ[1, f, e] .* F
        end #for f ∈ 1:nface
    end #e ∈ elems
end #function fluxrhs-1d

function fluxrhs!(rhs, Q::NamedTuple{S, NTuple{3, T}}, metric, ω, elems, vmapM,
                  vmapP) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux, Uy) = (Q.ρ, Q.Ux, Q.Uy)
    nface = 4
    (nx, ny, sJ) = (metric.nx, metric.ny, metric.sJ)
    for e ∈ elems
        for f ∈ 1:nface
            ρM = ρ[vmapM[:, f, e]]
            UxM = Ux[vmapM[:, f, e]]
            UyM = Uy[vmapM[:, f, e]]
            FxM = ρM .* UxM
            FyM = ρM .* UyM

            ρP = ρ[vmapP[:, f, e]]
            UxP = Ux[vmapP[:, f, e]]
            UyP = Uy[vmapP[:, f, e]]
            FxP = ρP .* UxP
            FyP = ρP .* UyP

            nxM = nx[:, f, e]
            nyM = ny[:, f, e]
            λ = max.(abs.(nxM .* UxM + nyM .* UyM), abs.(nxM .* UxP + nyM .* UyP))

            F = (nxM .* (FxM + FxP) + nyM .* (FyM + FyP) + λ .* (ρM - ρP)) / 2
            rhsρ[vmapM[:, f, e]] -= ω .* sJ[:, f, e] .* F
        end #f ∈ 1:nface
    end #e ∈ elems
end #function fluxrhs-2d

function fluxrhs!(rhs, Q::NamedTuple{S, NTuple{4, T}}, metric, ω, elems, vmapM,
                  vmapP) where {S, T}
    rhsρ = rhs.ρ
    (ρ, Ux, Uy, Uz) = (Q.ρ, Q.Ux, Q.Uy, Q.Uz)
    nface = 6
    (nx, ny, nz, sJ) = (metric.nx, metric.ny, metric.nz, metric.sJ)
    nx = reshape(nx, size(vmapM))
    ny = reshape(ny, size(vmapM))
    nz = reshape(nz, size(vmapM))
    sJ = reshape(sJ, size(vmapM))
    for e ∈ elems
        for f ∈ 1:nface
            ρM = ρ[vmapM[:, f, e]]
            UxM = Ux[vmapM[:, f, e]]
            UyM = Uy[vmapM[:, f, e]]
            UzM = Uz[vmapM[:, f, e]]
            FxM = ρM .* UxM
            FyM = ρM .* UyM
            FzM = ρM .* UzM

            ρP = ρ[vmapP[:, f, e]]
            UxP = Ux[vmapP[:, f, e]]
            UyP = Uy[vmapP[:, f, e]]
            UzP = Uz[vmapP[:, f, e]]
            FxP = ρP .* UxP
            FyP = ρP .* UyP
            FzP = ρP .* UzP

            nxM = nx[:, f, e]
            nyM = ny[:, f, e]
            nzM = nz[:, f, e]
            λ = max.(abs.(nxM .* UxM + nyM .* UyM + nzM .* UzM),
                     abs.(nxM .* UxP + nyM .* UyP + nzM .* UzP))

            F = (nxM .* (FxM + FxP) + nyM .* (FyM + FyP) + nzM .* (FzM + FzP) +
                 λ .* (ρM - ρP)) / 2
            rhsρ[vmapM[:, f, e]] -= kron(ω, ω) .* sJ[:, f, e] .* F
        end #f ∈ 1:nface
    end #e ∈ elems
end #function fluxrhs-3d

function updatesolution!(rhs, Q::NamedTuple{S, NTuple{2, T}}, metric, ω, elems,
                         rka, rkb, dt) where {S, T}
    J = metric.J
    M =  ω
    for (rhsq, q) ∈ zip(rhs, Q)
        for e ∈ elems
            q[:, e] += rkb * dt * rhsq[:, e] ./ ( M .* J[:, e])
            rhsq[:, e] *= rka
        end
    end
end

function updatesolution!(rhs, Q::NamedTuple{S, NTuple{3, T}}, metric, ω, elems,
                         rka, rkb, dt) where {S, T}
    J = metric.J
    M = reshape(kron(ω, ω), length(ω), length(ω))
    for (rhsq, q) ∈ zip(rhs, Q)
        for e ∈ elems
            q[:, :, e] += rkb * dt * rhsq[:, :, e] ./ (M .* J[:, :, e])
            rhsq[:, :, e] *= rka
        end
    end
end

function updatesolution!(rhs, Q::NamedTuple{S, NTuple{4, T}}, metric, ω, elems,
                         rka, rkb, dt) where {S, T}
    J = metric.J
    M = reshape(kron(ω, ω, ω), length(ω), length(ω), length(ω))
    for (rhsq, q) ∈ zip(rhs, Q)
        for e ∈ elems
            q[:, :, :, e] += rkb * dt * rhsq[:, :, :, e] ./ (M .* J[:, :, :, e])
            rhsq[:, :, :, e] *= rka
        end
    end
end

function L2energy(Q::NamedTuple{S, NTuple{2, T}}, metric, ω, elems) where {S, T}
  J = metric.J
  Nq = length(ω)
  M = ω
  index = CartesianIndices(ntuple(j-&gt;1:Nq, Val(1)))

  energy = [zero(J[1])]
  for q ∈ Q
    for e ∈ elems
      for ind ∈ index
        energy[1] += M[ind] * J[ind, e] * q[ind, e]^2
      end
    end
  end
  energy[1]
end

function L2energy(Q::NamedTuple{S, NTuple{3, T}}, metric, ω, elems) where {S, T}
  J = metric.J
  Nq = length(ω)
  M = reshape(kron(ω, ω), Nq, Nq)
  index = CartesianIndices(ntuple(j-&gt;1:Nq, Val(2)))

  energy = [zero(J[1])]
  for q ∈ Q
    for e ∈ elems
      for ind ∈ index
        energy[1] += M[ind] * J[ind, e] * q[ind, e]^2
      end
    end
  end
  energy[1]
end

function L2energy(Q::NamedTuple{S, NTuple{4, T}}, metric, ω, elems) where {S, T}
  J = metric.J
  Nq = length(ω)
  M = reshape(kron(ω, ω, ω), Nq, Nq, Nq)
  index = CartesianIndices(ntuple(j-&gt;1:Nq, Val(3)))

  energy = [zero(J[1])]
  for q ∈ Q
    for e ∈ elems
      for ind ∈ index
        energy[1] += M[ind] * J[ind, e] * q[ind, e]^2
      end
    end
  end
  energy[1]
end

numnabr = length(mesh.nabrtorank)

sendreq = fill(MPI.REQUEST_NULL, numnabr)
recvreq = fill(MPI.REQUEST_NULL, numnabr)

sendQ = Array{DFloat, 3}(undef, (N+1)^dim, length(Q), length(mesh.sendelems))
recvQ = Array{DFloat, 3}(undef, (N+1)^dim, length(Q), length(mesh.ghostelems))

index = CartesianIndices(ntuple(j-&gt;1:N+1, dim))
nrealelem = length(mesh.realelems)

include(joinpath(@__DIR__, &quot;vtk.jl&quot;))
writemesh(@sprintf(&quot;Advection%dD_rank_%04d_step_%05d&quot;, dim, mpirank, 0),
          coord...; fields=((&quot;ρ&quot;, Q.ρ),), realelems=mesh.realelems)

for step = 1:nsteps
    mpirank == 0 &amp;&amp; @show step
    for s = 1:length(RKA)

        for (nnabr, nabrrank, nabrelem) ∈ zip(1:numnabr, mesh.nabrtorank,
                                              mesh.nabrtorecv)
            recvreq[nnabr] = MPI.Irecv!((@view recvQ[:, :, nabrelem]), nabrrank, 777,
                                        mpicomm)
        end

        MPI.Waitall!(sendreq)

        for (ne, e) ∈ enumerate(mesh.sendelems)
            for (nf, f) ∈ enumerate(Q)
                sendQ[:, nf, ne] = f[index[:], e]
            end
        end

        for (nnabr, nabrrank, nabrelem) ∈ zip(1:numnabr, mesh.nabrtorank,
                                              mesh.nabrtosend)
            sendreq[nnabr] = MPI.Isend((@view sendQ[:, :, nabrelem]), nabrrank, 777,
                                       mpicomm)
        end

        volumerhs!(rhs, Q, metric, D, ω, mesh.realelems)

        MPI.Waitall!(recvreq)

        for elems ∈ mesh.nabrtorecv
            for (nf, f) ∈ enumerate(Q)
                f[index[:], nrealelem .+ elems] = recvQ[:, nf, elems]
            end
        end

        fluxrhs!(rhs, Q, metric, ω, mesh.realelems, vmapM, vmapP)

        updatesolution!(rhs, Q, metric, ω, mesh.realelems, RKA[s%length(RKA)+1],
                        RKB[s], dt)
    end

    writemesh(@sprintf(&quot;Advection%dD_rank_%04d_step_%05d&quot;, dim, mpirank, step),
              coord...; fields=((&quot;ρ&quot;, Q.ρ),), realelems=mesh.realelems)
end

for (δ, q) ∈ zip(Δ, Q)
    δ .-= q
end
eng = L2energy(Q, metric, ω, mesh.realelems)
eng = MPI.Allreduce(eng, MPI.SUM, mpicomm)
mpirank == 0 &amp;&amp; @show sqrt(eng)

err = L2energy(Δ, metric, ω, mesh.realelems)
err = MPI.Allreduce(err, MPI.SUM, mpicomm)
mpirank == 0 &amp;&amp; @show sqrt(err)

nothing

# This file was generated using Literate.jl, https://github.com/fredrikekre/Literate.jl</code></pre><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../../../manual/operators/"><span class="direction">Previous</span><span class="title">Element Operators</span></a><a class="next" href="../shallow_water/"><span class="direction">Next</span><span class="title">Shallow Water Equations Example</span></a></footer></article></body></html>
